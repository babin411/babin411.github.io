<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Advanced CRUD Operations" /><meta name="author" content="Babin" /><meta property="og:locale" content="en" /><meta name="description" content="MQL Operators Update Operators: Example: $inc, $set, $unset These update operators enable us to modify data in the database." /><meta property="og:description" content="MQL Operators Update Operators: Example: $inc, $set, $unset These update operators enable us to modify data in the database." /><link rel="canonical" href="https://babin411.github.io/posts/mongodb4/" /><meta property="og:url" content="https://babin411.github.io/posts/mongodb4/" /><meta property="og:site_name" content="Babin Joshi" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-15T00:00:00+05:45" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Advanced CRUD Operations" /><meta name="twitter:site" content="@BabinJoshi411" /><meta name="twitter:creator" content="@Babin" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Babin"},"dateModified":"2022-06-16T11:44:02+05:45","datePublished":"2022-06-15T00:00:00+05:45","description":"MQL Operators Update Operators: Example: $inc, $set, $unset These update operators enable us to modify data in the database.","headline":"Advanced CRUD Operations","mainEntityOfPage":{"@type":"WebPage","@id":"https://babin411.github.io/posts/mongodb4/"},"url":"https://babin411.github.io/posts/mongodb4/"}</script><title>4. Advanced CRUD Operations | Babin Joshi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Babin Joshi"><meta name="application-name" content="Babin Joshi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/dp.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Babin Joshi</a></div><div class="site-subtitle font-italic">Life is a cruel prank played on the living - Charles Boyle</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/babin411" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/BabinJoshi411" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['j.babin411','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>4. Advanced CRUD Operations</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>4. Advanced CRUD Operations</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Babinjoshi411">Babin Joshi</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1655230500" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-15 </em> </span> <span> Updated <em class="timeago" data-ts="1655359142" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-16 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1264 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><h2 id="mql-operators"><span class="mr-2">MQL Operators</span><a href="#mql-operators" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><p><strong>Update Operators</strong>: Example: <code class="language-plaintext highlighter-rouge">$inc</code>, <code class="language-plaintext highlighter-rouge">$set</code>, <code class="language-plaintext highlighter-rouge">$unset</code> These update operators enable us to modify data in the database.</p><li><p><strong>Query Operators</strong>: Query Operators provides additional ways to locate data within the database. What Query Operators have in common with all kinds of operators is the <code class="language-plaintext highlighter-rouge">$</code> sign that precedes the operator.</p><blockquote><p>Note: <code class="language-plaintext highlighter-rouge">$</code> has multiple uses in MongoDB like:</p><ul><li>It precedes MQL operators<li>It precedes aggregation pipeline stages.<li>Allows to access field values.</ul></blockquote><li><strong>Comparison Operators</strong>:<ul><li><code class="language-plaintext highlighter-rouge">$eq</code> = <strong>EQ</strong>ual to : Allows to compare if the two values are equal<li><code class="language-plaintext highlighter-rouge">$ne</code> = <strong>N</strong>ot <strong>E</strong>qual to : Allows us to compare if the two values are not equal<li><code class="language-plaintext highlighter-rouge">$gt</code> = <strong>G</strong>reater <strong>T</strong>han<li><code class="language-plaintext highlighter-rouge">$gte</code> = <strong>G</strong>reater <strong>T</strong>han or <strong>E</strong>qual<li><code class="language-plaintext highlighter-rouge">$lt</code> = <strong>L</strong>ess <strong>T</strong>han<li><code class="language-plaintext highlighter-rouge">$lte</code> = <strong>L</strong>ess <strong>T</strong>han or <strong>E</strong>qual</ul><p>The Syntax for the Comparision Operators is:</p><p>Syntax:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>      {
          &lt;field&gt; : {
              &lt;operator&gt; : &lt;value&gt;
          }
      }
</pre></table></code></div></div><p>Example-1:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>      db.trips.find(
                      { 
                          "tripduration": { 
                                              "$lte" : 70 
                                          },
                          "usertype": { 
                                          "$ne": "Subscriber"
                                      } 
                      }
                  ).pretty()

</pre></table></code></div></div><blockquote class="prompt-info"><div><p>The above query finds all the documents in the <code class="language-plaintext highlighter-rouge">trips</code> collections where the <code class="language-plaintext highlighter-rouge">tripduration</code> was less than or equal to <code class="language-plaintext highlighter-rouge">70</code> seconds and the <code class="language-plaintext highlighter-rouge">usertype</code> was <strong>not</strong> <code class="language-plaintext highlighter-rouge">Subscriber</code></p></div></blockquote><p>Example-2:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>      db.trips.find(
                      { 
                          "tripduration": { 
                                              "$lte" : 70 
                                          },
                          "usertype": { 
                                          "$eq": "Customer" 
                                      }
                      }
                  ).pretty()
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>The above query finds all the documents where the <code class="language-plaintext highlighter-rouge">tripduration</code> was less than or equal to <code class="language-plaintext highlighter-rouge">70</code> and the <code class="language-plaintext highlighter-rouge">usertype</code> was <code class="language-plaintext highlighter-rouge">Customer</code> using a redundant equality operator.</p></div></blockquote><p>Example-3:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>      db.trips.find(
                      { 
                          "tripduration": { 
                                              "$lte" : 70 
                                          },
                          "usertype": "Customer" 
                      }
                  ).pretty()
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>The above query finds all the documents where the <code class="language-plaintext highlighter-rouge">tripduration</code> was less than or equal to <code class="language-plaintext highlighter-rouge">70</code> seconds and the <code class="language-plaintext highlighter-rouge">usertype</code> was <code class="language-plaintext highlighter-rouge">Customer</code> using the implicit equality operator.</p></div></blockquote><li><strong>Logic Operators</strong> In MQL, we have the standard set of foru logical operators which are given below:-<ul><li><code class="language-plaintext highlighter-rouge">$and</code>: Returns the documents that meets <strong>all</strong> of the specified query clauses.<li><code class="language-plaintext highlighter-rouge">$or</code>: Returns the documents as long as <strong>at least one</strong> of the query clauses is matched.<li><code class="language-plaintext highlighter-rouge">$nor</code>: Returns all documents that <strong>fails to match</strong> both clauses.<li><code class="language-plaintext highlighter-rouge">$not</code>: Negates the query requirements and therefore returns all the documents that <strong>do not match</strong> the query.</ul><p>The and, or and nor have the similar syntax where the operator precedes an array of clauses that it will operate o.</p><p>Syntax for and, or and nor operators:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>      {
          &lt;operator&gt;: [{statement1}, {statement2},...]
      }
</pre></table></code></div></div><p>Syntax for not operator:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>      {
          $not: {statement}
      }
</pre></table></code></div></div><p>Example-1:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>      db.inspections.find(
          {
              '$nor': [{
                  'result': 'No violation'
              }, 
              {
                  'result': 'Pass'
              },
              {
                  'result': 'Fail'
              }]
          }
      )
</pre></table></code></div></div><p>The above query ensures that every document with the result set to No violation or Pass or Fail will not be part of the result.</p><p>Example-2:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>  db.grades.find({
          '$and': [
              {
                  'student_id': {
                      '$gt': 25
                  }
              }, 
              {
                  'student_id': {
                      '$lt': 100
                  }
              }
          ]
      })
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>The above query finds all the students where the <code class="language-plaintext highlighter-rouge">student_id</code> is greater than 25 and less than 100 in the <code class="language-plaintext highlighter-rouge">sample_training.grades</code> ccollections.</p></div></blockquote><p>But we could also simplify it significantly as we’re querying on the same field, we can get rid of the implied <code class="language-plaintext highlighter-rouge">$and</code>. Then, we can also combine both conditions in a single statement like:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>      db.grades.find({
          'student_it': {
              '$gt': 25,
              '$lt':100
          }
      })
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>The above query does the same as the one above it but only simpler.</p></div></blockquote><p>Example-3:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>      db.routes.find(
                      { "$and": [ 
                                  { "$or" :[ 
                                              { "dst_airport": "KZN" },
                                              { "src_airport": "KZN" }
                                          ] 
                                  },
                                  { "$or" :[ 
                                              { "airplane": "CR2" },
                                              { "airplane": "A81" } 
                                          ] 
                                  }
                              ]
                      }
                  ).pretty()
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>The above query finds all documents where airplanes<code class="language-plaintext highlighter-rouge">CR2</code> or <code class="language-plaintext highlighter-rouge">A81</code> left or landed in the <code class="language-plaintext highlighter-rouge">KZN</code> airport.</p></div></blockquote><li><p><strong>Expressive Query Operator</strong> The <code class="language-plaintext highlighter-rouge">$expr</code> is an expressive query operator meaning it can do more than one simple operation. It allows the use of aggregation expressions within the query language and it uses this syntax. It allows for more complex queries and for comparing fields within a document.</p><p>Syntax:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>      {
          $expr: {
              &lt;expression&gt;
          }
      }
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">$expr</code> also allows us to use variables and conditional statements.</p><p>Example-1:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>      db.trips.find(
                      { "$expr": { 
                          "$eq": [ 
                                      "$end station id", 
                                      "$start station id"
                                  ] 
                                  }
                      }
                  ).count()
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>The above query allows us to find all the documents where the trip started and ended at the same station.</p></div></blockquote><p>Example-2:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>      db.trips.find(
                      {
                          '$expr': {
                              '$and': [
                                  {
                                      '$gt': [
                                          '$tripduration', 1200
                                      ]
                                  },
                                  {
                                      '$eq': [
                                          '$end station id', '$start station id'
                                      ]
                                  }
                              ]
                          }
                      }
                  ).count()
</pre></table></code></div></div><li><strong>Array Operators and Projection</strong><ul><li><p><code class="language-plaintext highlighter-rouge">$push</code>: It allows us to add an element to an array. It also allows us to turn a field into an array field if it was previously a different type.</p><li><p><code class="language-plaintext highlighter-rouge">$sall</code>: It returns a cursor with all docuements in which the specified array field contains all the given elements, regardless of their order in the array.</p><li><p><code class="language-plaintext highlighter-rouge">$size</code>: It returns all documents whree the specified array field is exactly the given length.</p></ul><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre>      db.listingsAndReviews.find(
                                  { "amenities": {
                                                  "$size": 20,
                                                  "$all": [ 
                                                              "Internet", 
                                                              "Wifi", 
                                                              "Kitchen",
                                                              "Heating",
                                                              "Family/kid friendly",
                                                              "Washer", 
                                                              "Dryer", 
                                                              "Essentials",
                                                              "Shampoo", 
                                                              "Hangers",
                                                              "Hair dryer", 
                                                              "Iron",
                                                              "Laptop friendly workspace"
                                                          ]
                                                  }
                                  }
                              ).pretty()
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>The above query finds all the documetns with exactly 20 <code class="language-plaintext highlighter-rouge">amenities</code> which includes all the <code class="language-plaintext highlighter-rouge">amenities</code> listed in the query array.</p></div></blockquote><p>When we look at the <code class="language-plaintext highlighter-rouge">sample_airbnb</code> dataset, we see documents with lots of fields that often don’t fit on the screen. To mitigate this, we can add a projection to our Find queries and only look at fiends that we’re interested in at the moment.</p><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>      db.listingsAndReviews.find(
          {
              'amenities': {
                  '$size': 20, 
                  '$all': ['Internet', 'Wifi', 'Kitchen', 'Heating']
              }
          }, 
          {
              'price': 1,
              'address': 1
          }
      ).pretty()
</pre></table></code></div></div><p>The first part of the <code class="language-plaintext highlighter-rouge">find()</code> query describes the content that we’re looking for. The second is a projection, describing specifically which fields we’re looking for. This way, the cursor doesn’t have to include every single field in the result set.</p><blockquote class="prompt-tip"><div><p><strong>Note</strong>: When using projection, you can specify which fields you do or do not want to see in the resulting cursor. Use 1 to specify the fields that you want to see, and 0 to specify the fields that you don’t want to see. You cannot mix zeros and ones in a single projection.</p></div></blockquote><ul><li><code class="language-plaintext highlighter-rouge">$elemMatch</code>: An Array Operator that can be used both in query and projection part of the find command. It matches the documents that contain an array field with at least one element that matches the specified query criteria.</ul><p>Syntax:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>      {
          &lt;field&gt;: {
              '$elemMatch': {
                  &lt;field&gt; : &lt;value&gt;
              }
          }
      }
</pre></table></code></div></div><p>Example-1:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>      db.grades.find(
          {
              'class_id': 431
          },
          {
              'scores': {
                  '$elemMatch': {
                      'score': {
                          '$gt': 85
                      }
                  }
              }
          }
      ).pretty()
</pre></table></code></div></div><p>Example-2:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>      db.grades.find(
          {
              'scores': {
                  '$elemMatch': {
                      'type': 'extra credit'
                  }
              }
          }
      ).pretty()
</pre></table></code></div></div></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/mongodb/'>MongoDB</a>, <a href='/categories/mongodb-basics/'>MongoDB Basics</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/mongodb/" class="post-tag no-text-decoration" >mongodb</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=4. Advanced CRUD Operations - Babin Joshi&amp;url=https://babin411.github.io/posts/mongodb4/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=4. Advanced CRUD Operations - Babin Joshi&amp;u=https://babin411.github.io/posts/mongodb4/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://babin411.github.io/posts/mongodb4/&amp;text=4. Advanced CRUD Operations - Babin Joshi" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/wildcards/">Wild Cards Tutorial</a><li><a href="/posts/Linux-Basic-Commands/">Basic Linux Commands</a><li><a href="/posts/3sql4/">Window Functions</a><li><a href="/posts/pandas1/">Introduction to Pandas</a><li><a href="/posts/mongodb-dm4/">4. Patterns 2</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/sql/">sql</a> <a class="post-tag" href="/tags/t-sql/">t-sql</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mongodb/">mongodb</a> <a class="post-tag" href="/tags/curl/">curl</a> <a class="post-tag" href="/tags/wget/">wget</a> <a class="post-tag" href="/tags/avg/">avg</a> <a class="post-tag" href="/tags/count/">count</a> <a class="post-tag" href="/tags/max/">max</a> <a class="post-tag" href="/tags/min/">min</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/mongodb1/"><div class="card-body"> <em class="timeago small" data-ts="1655144100" > 2022-06-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>1. What is MongoDB?</h3><div class="text-muted small"><p> What is a MongoDB Database? A database, meaning a structured way to store and access data. More specifically, it is a NoSQL database. NoSQL databases mean that it doesn’t use the traditional appro...</p></div></div></a></div><div class="card"> <a href="/posts/mongodb2/"><div class="card-body"> <em class="timeago small" data-ts="1655144100" > 2022-06-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>2. Importing, Exporting, and Querying Data</h3><div class="text-muted small"><p> How Does MongoDB Store Data? MongoDB uses documents to store data. When we view or update documents in the MongoDB shell, you’re working in JSON which stands for ‘JavaScript Standard Object Notati...</p></div></div></a></div><div class="card"> <a href="/posts/mongodb3/"><div class="card-body"> <em class="timeago small" data-ts="1655144100" > 2022-06-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>3. Creating and Manipulating Documents</h3><div class="text-muted small"><p> Inserting New Documents Every MongoDB document must have unique _id value. ANd every _id field in a collection must have a unique value from the rest of the documents in the collection. Likewise, ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/mongodb3/" class="btn btn-outline-primary" prompt="Older"><p>3. Creating and Manipulating Documents</p></a> <a href="/posts/mongodb5/" class="btn btn-outline-primary" prompt="Newer"><p>5. Indexing and Aggregation Pipeline</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/Babinjoshi411">Babin Joshi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/sql/">sql</a> <a class="post-tag" href="/tags/t-sql/">t-sql</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mongodb/">mongodb</a> <a class="post-tag" href="/tags/curl/">curl</a> <a class="post-tag" href="/tags/wget/">wget</a> <a class="post-tag" href="/tags/avg/">avg</a> <a class="post-tag" href="/tags/count/">count</a> <a class="post-tag" href="/tags/max/">max</a> <a class="post-tag" href="/tags/min/">min</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
