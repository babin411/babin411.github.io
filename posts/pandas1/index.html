<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Introduction to Pandas" /><meta name="author" content="Babin" /><meta property="og:locale" content="en" /><meta name="description" content="Getting Started with Pandas Pandas contains data structures and data manipulation tools designed to make data cleaning and analysis fast and easy in Python." /><meta property="og:description" content="Getting Started with Pandas Pandas contains data structures and data manipulation tools designed to make data cleaning and analysis fast and easy in Python." /><link rel="canonical" href="https://babin411.github.io/posts/pandas1/" /><meta property="og:url" content="https://babin411.github.io/posts/pandas1/" /><meta property="og:site_name" content="Babin Joshi" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-22T00:00:00+05:45" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Introduction to Pandas" /><meta name="twitter:site" content="@BabinJoshi411" /><meta name="twitter:creator" content="@Babin" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Babin"},"dateModified":"2022-06-28T19:18:13+05:45","datePublished":"2022-06-22T00:00:00+05:45","description":"Getting Started with Pandas Pandas contains data structures and data manipulation tools designed to make data cleaning and analysis fast and easy in Python.","headline":"Introduction to Pandas","mainEntityOfPage":{"@type":"WebPage","@id":"https://babin411.github.io/posts/pandas1/"},"url":"https://babin411.github.io/posts/pandas1/"}</script><title>Introduction to Pandas | Babin Joshi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Babin Joshi"><meta name="application-name" content="Babin Joshi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/dp.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Babin Joshi</a></div><div class="site-subtitle font-italic">Life is a cruel prank played on the living - Charles Boyle</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/babin411" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/BabinJoshi411" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['j.babin411','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Introduction to Pandas</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Introduction to Pandas</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Babinjoshi411">Babin Joshi</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1655835300" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-22 </em> </span> <span> Updated <em class="timeago" data-ts="1656423193" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-28 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="7107 words"> <em>39 min</em> read</span></div></div></div><div class="post-content"><h2 id="getting-started-with-pandas"><span class="mr-2">Getting Started with Pandas</span><a href="#getting-started-with-pandas" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Pandas contains data structures and data manipulation tools designed to make data cleaning and analysis fast and easy in Python.</p><p>While pandas adopts many coding idioms from NumPy, the biggest difference is that pandas is designed for working with tabular or heterogeneous data. NumPy, by contract, is best suited for working with homogeneous numerical array data.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">Series</span><span class="p">,</span> <span class="n">DataFrame</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
</pre></table></code></div></div><h2 id="introduction-to-pandas-data-structures"><span class="mr-2">Introduction to Pandas Data Structures</span><a href="#introduction-to-pandas-data-structures" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><strong>Series</strong> - is a one dimensional array-like object containing a sequence of values and an associated array of data labels, called its index.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="n">obj</span>
<span class="n">Output</span><span class="p">:</span> 
    <span class="mi">0</span>    <span class="mi">4</span>
    <span class="mi">1</span>    <span class="mi">7</span>
    <span class="mi">2</span>   <span class="o">-</span><span class="mi">5</span>
    <span class="mi">3</span>    <span class="mi">3</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

</pre></table></code></div></div><p>The string representation of a Series displayed interactively shows the index on the left and the values on the right. Since, we did not specify an index for the data, a default one consisting of the integers 0 through N-1 (where <code class="language-plaintext highlighter-rouge">N</code> is the length of the data) is created.</p><p>We can get the array representation and index objects of the Sereis via its ‘values’ and ‘index’ attributes respectively.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">obj</span><span class="p">.</span><span class="n">values</span>
<span class="n">Output</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>

<span class="n">obj</span><span class="p">.</span><span class="n">index</span>
<span class="n">Output</span><span class="p">:</span> <span class="n">RangeIndex</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></table></code></div></div><p>Often it will be desirable to create a Series with an index identifying each data point</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">obj2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'d'</span><span class="p">,</span><span class="s">'b'</span><span class="p">,</span><span class="s">'a'</span><span class="p">,</span><span class="s">'c'</span><span class="p">])</span>
<span class="n">obj2</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">d</span>    <span class="mi">4</span>
    <span class="n">b</span>    <span class="mi">7</span>
    <span class="n">a</span>   <span class="o">-</span><span class="mi">5</span>
    <span class="n">c</span>    <span class="mi">3</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">obj2</span><span class="p">.</span><span class="n">index</span>
<span class="n">Output</span><span class="p">:</span><span class="n">Index</span><span class="p">([</span><span class="s">'d'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'object'</span><span class="p">)</span>
</pre></table></code></div></div><p>We can use labels in the index when selecting single values or set of values.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="n">obj2</span><span class="p">[</span><span class="s">'a'</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span>

<span class="n">obj2</span><span class="p">[</span><span class="s">'d'</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span> <span class="mi">4</span>

<span class="n">obj2</span><span class="p">[[</span><span class="s">'c'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'d'</span><span class="p">]]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">c</span>    <span class="mi">3</span>
    <span class="n">a</span>   <span class="o">-</span><span class="mi">5</span>
    <span class="n">d</span>    <span class="mi">4</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">obj2</span><span class="p">[</span><span class="n">obj2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">d</span>    <span class="mi">4</span>
    <span class="n">b</span>    <span class="mi">7</span>
    <span class="n">c</span>    <span class="mi">3</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">obj2</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">d</span>     <span class="mi">8</span>
    <span class="n">b</span>    <span class="mi">14</span>
    <span class="n">a</span>   <span class="o">-</span><span class="mi">10</span>
    <span class="n">c</span>     <span class="mi">6</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="n">obj2</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">d</span>      <span class="mf">54.598150</span>
    <span class="n">b</span>    <span class="mf">1096.633158</span>
    <span class="n">a</span>       <span class="mf">0.006738</span>
    <span class="n">c</span>      <span class="mf">20.085537</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p><strong>Note:</strong> Series can also be thought of as a fixed-length, ordered dict, as it is a mapping of index values to data values&lt;/p&gt;</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="s">'b'</span> <span class="ow">in</span> <span class="n">obj2</span>
<span class="n">Output</span><span class="p">:</span> <span class="bp">True</span>

<span class="s">'e'</span> <span class="ow">in</span> <span class="n">obj2</span>
<span class="n">Output</span><span class="p">:</span> <span class="bp">False</span>
</pre></table></code></div></div><p>Converting a Python dict obj to a Series obj in pandas.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">sdata</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Ohio'</span><span class="p">:</span> <span class="mi">35000</span><span class="p">,</span> <span class="s">'Texas'</span><span class="p">:</span> <span class="mi">71000</span><span class="p">,</span> <span class="s">'Oregon'</span><span class="p">:</span> <span class="mi">16000</span><span class="p">,</span> <span class="s">'Utah'</span> <span class="p">:</span> <span class="mi">5000</span><span class="p">}</span>

<span class="n">obj3</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sdata</span><span class="p">)</span>

<span class="n">obj3</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">Ohio</span>      <span class="mi">35000</span>
    <span class="n">Texas</span>     <span class="mi">71000</span>
    <span class="n">Oregon</span>    <span class="mi">16000</span>
    <span class="n">Utah</span>       <span class="mi">5000</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></table></code></div></div><p>When we pass only a dict, the index in the resulting Series will have the dict’s keys in sorted order. We can override this by passing the dict keys in the order we want them to appear in the resulting Series.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nb">type</span><span class="p">(</span><span class="n">sdata</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>    <span class="nb">dict</span>

<span class="nb">type</span><span class="p">(</span><span class="n">obj3</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>    <span class="n">pandas</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">series</span><span class="p">.</span><span class="n">Series</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="s">'California'</span><span class="p">,</span> <span class="s">'Ohio'</span><span class="p">,</span> <span class="s">'Oregon'</span><span class="p">,</span> <span class="s">'Texas'</span><span class="p">]</span>
<span class="n">obj4</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sdata</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">states</span><span class="p">)</span>
<span class="n">obj4</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">California</span>        <span class="n">NaN</span>
    <span class="n">Ohio</span>          <span class="mf">35000.0</span>
    <span class="n">Oregon</span>        <span class="mf">16000.0</span>
    <span class="n">Texas</span>         <span class="mf">71000.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>Here, 3 values found in sdata were placed in the appropriate locations, but since no value for ‘California’ was found, it appears as <code class="language-plaintext highlighter-rouge">NaN(not a number)</code>, which is considered in pandas to mark missing or NA values.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">pd</span><span class="p">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">obj4</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">California</span>     <span class="bp">True</span>
    <span class="n">Ohio</span>          <span class="bp">False</span>
    <span class="n">Oregon</span>        <span class="bp">False</span>
    <span class="n">Texas</span>         <span class="bp">False</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>

<span class="n">pd</span><span class="p">.</span><span class="n">notnull</span><span class="p">(</span><span class="n">obj4</span><span class="p">)</span>
    <span class="n">California</span>    <span class="bp">False</span>
    <span class="n">Ohio</span>           <span class="bp">True</span>
    <span class="n">Oregon</span>         <span class="bp">True</span>
    <span class="n">Texas</span>          <span class="bp">True</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>
</pre></table></code></div></div><p>The ‘isnull’ and ‘notnull’ functions in pandas should be used to detect missing data.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="n">obj4</span><span class="p">.</span><span class="n">isnull</span><span class="p">()</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">California</span>     <span class="bp">True</span>
    <span class="n">Ohio</span>          <span class="bp">False</span>
    <span class="n">Oregon</span>        <span class="bp">False</span>
    <span class="n">Texas</span>         <span class="bp">False</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>

<span class="n">obj3</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">Ohio</span>      <span class="mi">35000</span>
    <span class="n">Texas</span>     <span class="mi">71000</span>
    <span class="n">Oregon</span>    <span class="mi">16000</span>
    <span class="n">Utah</span>       <span class="mi">5000</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">obj4</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">California</span>        <span class="n">NaN</span>
    <span class="n">Ohio</span>          <span class="mf">35000.0</span>
    <span class="n">Oregon</span>        <span class="mf">16000.0</span>
    <span class="n">Texas</span>         <span class="mf">71000.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj3</span> <span class="o">+</span> <span class="n">obj4</span>
    <span class="n">California</span>         <span class="n">NaN</span>
    <span class="n">Ohio</span>           <span class="mf">70000.0</span>
    <span class="n">Oregon</span>         <span class="mf">32000.0</span>
    <span class="n">Texas</span>         <span class="mf">142000.0</span>
    <span class="n">Utah</span>               <span class="n">NaN</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>Both the Series object itself and its index have a <strong>name</strong> attribute, which integrates with other key areas of pandas funcitonality:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="n">obj4</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'population'</span>

<span class="n">obj4</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'state'</span>

<span class="n">obj4</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">state</span>
    <span class="n">California</span>        <span class="n">NaN</span>
    <span class="n">Ohio</span>          <span class="mf">35000.0</span>
    <span class="n">Oregon</span>        <span class="mf">16000.0</span>
    <span class="n">Texas</span>         <span class="mf">71000.0</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">population</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>A series index can be altered in-place by assignment:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="n">obj</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">0</span>    <span class="mi">4</span>
    <span class="mi">1</span>    <span class="mi">7</span>
    <span class="mi">2</span>   <span class="o">-</span><span class="mi">5</span>
    <span class="mi">3</span>    <span class="mi">3</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">obj</span><span class="p">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Bob'</span><span class="p">,</span> <span class="s">'Seteve'</span> <span class="p">,</span><span class="s">'Jeff'</span><span class="p">,</span> <span class="s">'Ryan'</span><span class="p">]</span>

<span class="n">obj</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">Bob</span>       <span class="mi">4</span>
    <span class="n">Seteve</span>    <span class="mi">7</span>
    <span class="n">Jeff</span>     <span class="o">-</span><span class="mi">5</span>
    <span class="n">Ryan</span>      <span class="mi">3</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></table></code></div></div><p><strong>DataFrame:</strong> A DataFrame represents a rectangular table of data and condains an ordered collection of columns, each of which can be a different value type (numeric, string, boolean, etc.). The DataFrame has both a row and column index; it can be thought of as a dict of Series all sharing the same index.</p><blockquote class="prompt-tip"><div><p>Note: While a DataFrame is physically two-dimensional, we can use it to represent higher dimensional data in a tabular formati using heirarchial indexing.</p></div></blockquote><p>There are many ways to create a DataFrame, though one of the most common is from a dict of equal-length lists or NumPy array:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">'state'</span><span class="p">:</span> <span class="p">[</span><span class="s">'Ohio'</span><span class="p">,</span> <span class="s">'Ohio'</span><span class="p">,</span> <span class="s">'Ohio'</span><span class="p">,</span> <span class="s">'Nevada'</span><span class="p">,</span> <span class="s">'Nevada'</span><span class="p">,</span> <span class="s">'Nevada'</span><span class="p">],</span>
       <span class="s">'year'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2001</span><span class="p">,</span><span class="mi">2002</span><span class="p">,</span><span class="mi">2001</span><span class="p">,</span><span class="mi">2002</span><span class="p">,</span><span class="mi">2003</span><span class="p">],</span>
       <span class="s">'pop'</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.7</span><span class="p">,</span><span class="mf">3.6</span><span class="p">,</span><span class="mf">2.4</span><span class="p">,</span><span class="mf">2.9</span><span class="p">,</span><span class="mf">3.2</span><span class="p">]}</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">frame</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>pop<td>state<td>year<tr><td>0<td>1.5<td>Ohio<td>2000<tr><td>1<td>1.7<td>Ohio<td>2001<tr><td>2<td>3.6<td>Ohio<td>2002<tr><td>3<td>2.4<td>Nevada<td>2001<tr><td>4<td>2.9<td>Nevada<td>2002<tr><td>5<td>3.2<td>Nevada<td>2003</table></div><p>For Large DataFrames, the head method selects only the first five rows&lt;</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">frame</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>pop<td>state<td>year<tr><td>0<td>1.5<td>Ohio<td>2000<tr><td>1<td>1.7<td>Ohio<td>2001<tr><td>2<td>3.6<td>Ohio<td>2002<tr><td>3<td>2.4<td>Nevada<td>2001<tr><td>4<td>2.9<td>Nevada<td>2002</table></div><p>If we specify a sequence of columns, the DataFrame’s columns will be arranged in that order:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'year'</span><span class="p">,</span> <span class="s">'state'</span><span class="p">,</span> <span class="s">'pop'</span><span class="p">])</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>year<td>state<td>pop<tr><td>0<td>2000<td>Ohio<td>1.5<tr><td>1<td>2001<td>Ohio<td>1.7<tr><td>2<td>2002<td>Ohio<td>3.6<tr><td>3<td>2001<td>Nevada<td>2.4<tr><td>4<td>2002<td>Nevada<td>2.9<tr><td>5<td>2003<td>Nevada<td>3.2</table></div><p>If passed a column that isn’t contained in the dict, it will appear with the missing values in the result:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">frame2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'year'</span><span class="p">,</span> <span class="s">'state'</span><span class="p">,</span> <span class="s">'pop'</span><span class="p">,</span> <span class="s">'debt'</span><span class="p">],</span> 
                      <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'one'</span><span class="p">,</span> <span class="s">'two'</span><span class="p">,</span> <span class="s">'three'</span><span class="p">,</span> <span class="s">'four'</span><span class="p">,</span> <span class="s">'five'</span><span class="p">,</span> <span class="s">'six'</span><span class="p">])</span>
<span class="n">frame2</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>year<td>state<td>pop<td>debt<tr><td>one<td>2000<td>Ohio<td>1.5<td>NaN<tr><td>two<td>2001<td>Ohio<td>1.7<td>NaN<tr><td>three<td>2002<td>Ohio<td>3.6<td>NaN<tr><td>four<td>2001<td>Nevada<td>2.4<td>NaN<tr><td>five<td>2002<td>Nevada<td>2.9<td>NaN<tr><td>six<td>2003<td>Nevada<td>3.2<td>NaN</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">frame2</span><span class="p">.</span><span class="n">columns</span>
<span class="n">Output</span><span class="p">:</span>    <span class="n">Index</span><span class="p">([</span><span class="s">'year'</span><span class="p">,</span> <span class="s">'state'</span><span class="p">,</span> <span class="s">'pop'</span><span class="p">,</span> <span class="s">'debt'</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'object'</span><span class="p">)</span>
</pre></table></code></div></div><p>We can retrive a column in a DataFrame as a Series either by dict-like notation or by attribute:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="n">frame2</span><span class="p">[</span><span class="s">'state'</span><span class="p">]</span>

<span class="n">Output</span><span class="p">:</span>
    <span class="n">one</span>        <span class="n">Ohio</span>
    <span class="n">two</span>        <span class="n">Ohio</span>
    <span class="n">three</span>      <span class="n">Ohio</span>
    <span class="n">four</span>     <span class="n">Nevada</span>
    <span class="n">five</span>     <span class="n">Nevada</span>
    <span class="n">six</span>      <span class="n">Nevada</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">state</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">frame2</span><span class="p">.</span><span class="n">year</span>
<span class="n">Output</span><span class="p">:</span> 
    <span class="n">one</span>      <span class="mi">2000</span>
    <span class="n">two</span>      <span class="mi">2001</span>
    <span class="n">three</span>    <span class="mi">2002</span>
    <span class="n">four</span>     <span class="mi">2001</span>
    <span class="n">five</span>     <span class="mi">2002</span>
    <span class="n">six</span>      <span class="mi">2003</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">year</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>Rows can also be retrieved by position or name with the special <code class="language-plaintext highlighter-rouge">loc</code> attribute .</p></div></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">frame2</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>year<td>state<td>pop<td>debt<tr><td>one<td>2000<td>Ohio<td>1.5<td>NaN<tr><td>two<td>2001<td>Ohio<td>1.7<td>NaN<tr><td>three<td>2002<td>Ohio<td>3.6<td>NaN<tr><td>four<td>2001<td>Nevada<td>2.4<td>NaN<tr><td>five<td>2002<td>Nevada<td>2.9<td>NaN<tr><td>six<td>2003<td>Nevada<td>3.2<td>NaN</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">frame2</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'three'</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span> 
    <span class="n">year</span>     <span class="mi">2002</span>
    <span class="n">state</span>    <span class="n">Ohio</span>
    <span class="n">pop</span>       <span class="mf">3.6</span>
    <span class="n">debt</span>      <span class="n">NaN</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">three</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></table></code></div></div><p>Columns can be modified by assignment. For example, the empty <code class="language-plaintext highlighter-rouge">debt</code> column could be assigned a scalar value or an array of values:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>
<span class="n">frame2</span><span class="p">[</span><span class="s">'debt'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">16.5</span>
<span class="n">frame2</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>year<td>state<td>pop<td>debt<tr><td>one<td>2000<td>Ohio<td>1.5<td>16.5<tr><td>two<td>2001<td>Ohio<td>1.7<td>16.5<tr><td>three<td>2002<td>Ohio<td>3.6<td>16.5<tr><td>four<td>2001<td>Nevada<td>2.4<td>16.5<tr><td>five<td>2002<td>Nevada<td>2.9<td>16.5<tr><td>six<td>2003<td>Nevada<td>3.2<td>16.5</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">frame2</span><span class="p">[</span><span class="s">'debt'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">6.</span><span class="p">)</span>
<span class="n">frame2</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>year<td>state<td>pop<td>debt<tr><td>one<td>2000<td>Ohio<td>1.5<td>0.0<tr><td>two<td>2001<td>Ohio<td>1.7<td>1.0<tr><td>three<td>2002<td>Ohio<td>3.6<td>2.0<tr><td>four<td>2001<td>Nevada<td>2.4<td>3.0<tr><td>five<td>2002<td>Nevada<td>2.9<td>4.0<tr><td>six<td>2003<td>Nevada<td>3.2<td>5.0</table></div><blockquote class="prompt-warning"><div><p>Note: When assigning lists or arrays to a column, we must make sure that the value’s length must match the length of the DataFrame. If we assign a Series, its labels will be realigned exactly to the DataFrame’s index, inserting missing values in any holes</p></div></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">val</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="o">-</span><span class="mf">1.7</span><span class="p">],</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'two'</span><span class="p">,</span> <span class="s">'four'</span><span class="p">,</span> <span class="s">'five'</span><span class="p">])</span>

<span class="n">frame2</span><span class="p">[</span><span class="s">'debt'</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
<span class="n">frame2</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>year<td>state<td>pop<td>debt<tr><td>one<td>2000<td>Ohio<td>1.5<td>NaN<tr><td>two<td>2001<td>Ohio<td>1.7<td>-1.2<tr><td>three<td>2002<td>Ohio<td>3.6<td>NaN<tr><td>four<td>2001<td>Nevada<td>2.4<td>-1.5<tr><td>five<td>2002<td>Nevada<td>2.9<td>-1.7<tr><td>six<td>2003<td>Nevada<td>3.2<td>NaN</table></div><p>Assinging a column that doesn’t exist will create a new column. And the ‘del’ keyword wil delete columns as with a dict.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">frame2</span><span class="p">[</span><span class="s">'eastern'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">frame2</span><span class="p">.</span><span class="n">state</span> <span class="o">==</span> <span class="s">'Ohio'</span><span class="p">)</span>
<span class="n">frame2</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>year<td>state<td>pop<td>debt<td>eastern<tr><td>one<td>2000<td>Ohio<td>1.5<td>NaN<td>True<tr><td>two<td>2001<td>Ohio<td>1.7<td>-1.2<td>True<tr><td>three<td>2002<td>Ohio<td>3.6<td>NaN<td>True<tr><td>four<td>2001<td>Nevada<td>2.4<td>-1.5<td>False<tr><td>five<td>2002<td>Nevada<td>2.9<td>-1.7<td>False<tr><td>six<td>2003<td>Nevada<td>3.2<td>NaN<td>False</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">del</span> <span class="n">frame2</span><span class="p">[</span><span class="s">'eastern'</span><span class="p">]</span>
<span class="n">frame2</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>year<td>state<td>pop<td>debt<tr><td>one<td>2000<td>Ohio<td>1.5<td>NaN<tr><td>two<td>2001<td>Ohio<td>1.7<td>-1.2<tr><td>three<td>2002<td>Ohio<td>3.6<td>NaN<tr><td>four<td>2001<td>Nevada<td>2.4<td>-1.5<tr><td>five<td>2002<td>Nevada<td>2.9<td>-1.7<tr><td>six<td>2003<td>Nevada<td>3.2<td>NaN</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">frame2</span><span class="p">.</span><span class="n">columns</span>
<span class="n">Output</span><span class="p">:</span> <span class="n">Index</span><span class="p">([</span><span class="s">'year'</span><span class="p">,</span> <span class="s">'state'</span><span class="p">,</span> <span class="s">'pop'</span><span class="p">,</span> <span class="s">'debt'</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'object'</span><span class="p">)</span>
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>Note: The column returned from indexing a DataFrame is a view on the underlying data, not a copy. Thus, any in-place modifications to the Series will be reflected in the DataFrame. The column can be explicitely copied with the Series’s copy method.</p></div></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">pop</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Nevada'</span><span class="p">:</span> <span class="p">{</span><span class="mi">2001</span><span class="p">:</span> <span class="mf">2.4</span><span class="p">,</span> <span class="mi">2002</span><span class="p">:</span> <span class="mf">2.9</span><span class="p">},</span>
      <span class="s">'Ohio'</span><span class="p">:{</span><span class="mi">2000</span><span class="p">:</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">2001</span><span class="p">:</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mi">2002</span><span class="p">:</span> <span class="mf">3.6</span><span class="p">}}</span>
</pre></table></code></div></div><p>If the nested dict is passed to the DataFrame, pandas will intrepret the outer dict keys as the columns and the inner dict keys as the rows indices</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">frame3</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pop</span><span class="p">)</span>
<span class="n">frame3</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>Nevada<td>Ohio<tr><td>2001<td>2.4<td>1.7<tr><td>2002<td>2.9<td>3.6<tr><td>2000<td>NaN<td>1.5</table></div><p>We can transpose the DataFrame with similar syntax as in Numpy array. Here, the tranposed dataframe will just be a copy and not a view.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>  <span class="n">frame3</span><span class="p">.</span><span class="n">T</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>2000<td>2001<td>2002<tr><td>Nevada<td>NaN<td>2.4<td>2.9<tr><td>Ohio<td>1.5<td>1.7<td>3.6</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">frame3</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>Nevada<td>Ohio<tr><td>2001<td>2.4<td>1.7<tr><td>2002<td>2.9<td>3.6<tr><td>2000<td>NaN<td>1.5</table></div><p>The keys in the inner dicts are combined and sorted to form the index in the result. This isn’t true if an explicit index is specified:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2001</span><span class="p">,</span><span class="mi">2002</span><span class="p">,</span><span class="mi">2003</span><span class="p">])</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>Nevada<td>Ohio<tr><td>2001<td>2.4<td>1.7<tr><td>2002<td>2.9<td>3.6<tr><td>2003<td>NaN<td>NaN</table></div><p>The Dict of Sereis are treated in much the same way</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">pdata</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Ohio'</span><span class="p">:</span> <span class="n">frame3</span><span class="p">[</span><span class="s">'Ohio'</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="s">'Nevada'</span><span class="p">:</span><span class="n">frame3</span><span class="p">[</span><span class="s">'Nevada'</span><span class="p">][:</span><span class="mi">2</span><span class="p">]}</span>
<span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pdata</span><span class="p">)</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>Nevada<td>Ohio<tr><td>2000<td>NaN<td>1.5<tr><td>2001<td>2.4<td>1.7</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">frame3</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>Nevada<td>Ohio<tr><td>2001<td>2.4<td>1.7<tr><td>2002<td>2.9<td>3.6<tr><td>2000<td>NaN<td>1.5</table></div><p>If a DataFrame’s index and columns have their name attribtues set, these will also be displayed along with the frame</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">frame3</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'year'</span><span class="p">;</span> <span class="n">frame3</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'state'</span>
<span class="n">frame3</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td>state<td>Nevada<td>Ohio<tr><td>year<td> <td> <tr><td>2000<td>NaN<td>1.5<tr><td>2001<td>2.4<td>1.7<tr><td>2002<td>2.9<td>3.6</table></div><p>As with Series, the values attribute returns the data contained in the DataFrame as a two-dimensional ndarray</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">frame3</span><span class="p">.</span><span class="n">values</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">array</span><span class="p">([[</span><span class="mf">2.4</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">],</span>
           <span class="p">[</span><span class="mf">2.9</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">],</span>
           <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]])</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">frame2</span><span class="p">.</span><span class="n">values</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">array</span><span class="p">([[</span><span class="mi">2000</span><span class="p">,</span> <span class="s">'Ohio'</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">2001</span><span class="p">,</span> <span class="s">'Ohio'</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="s">'Ohio'</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">2001</span><span class="p">,</span> <span class="s">'Nevada'</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">2002</span><span class="p">,</span> <span class="s">'Nevada'</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.7</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">2003</span><span class="p">,</span> <span class="s">'Nevada'</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="n">nan</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></table></code></div></div><p><img data-src="/assets/img/dataframe_constructor.png" alt="img" data-proofer-ignore></p><h2 id="index-objects"><span class="mr-2">Index Objects</span><a href="#index-objects" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Pandas’s Index objects are responsible for holding the axis lables and other metadata. Any array or other sequence of labels we use when constructing a <code class="language-plaintext highlighter-rouge">Series</code> or <code class="language-plaintext highlighter-rouge">DataFrame</code> is internally convertedto an Index:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span><span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">])</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">obj</span><span class="p">.</span><span class="n">index</span>
<span class="n">index</span>
<span class="n">Output</span><span class="p">:</span> <span class="n">Index</span><span class="p">([</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'object'</span><span class="p">)</span>

<span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">Output</span><span class="p">:</span> <span class="n">Index</span><span class="p">([</span><span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'object'</span><span class="p">)</span>
</pre></table></code></div></div><p>Index objects are <code class="language-plaintext highlighter-rouge">IMMUTABLE</code> and thus can’t be modified by the user. Thus makes it safer to share Index objects among data structures.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="n">labels</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Index</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="n">labels</span>
<span class="n">Output</span><span class="p">:</span> <span class="n">Int64Index</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'int64'</span><span class="p">)</span>

<span class="n">obj2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span><span class="n">index</span> <span class="o">=</span> <span class="n">labels</span><span class="p">)</span>

<span class="n">obj2</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">0</span>    <span class="mf">1.5</span>
    <span class="mi">1</span>    <span class="mf">2.5</span>
    <span class="mi">2</span>    <span class="mf">0.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj2</span><span class="p">.</span><span class="n">index</span> <span class="ow">is</span> <span class="n">labels</span>
<span class="n">Output</span><span class="p">:</span> <span class="bp">True</span>
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>Some users will not often take advantage of the capabilities pro‐ vided by indexes, but because some operations will yield results containing indexed data, it’s important to understand how they work.</p></div></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">frame3</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td>state<td>Nevada<td>Ohio<tr><td>year<td> <td> <tr><td>2001<td>2.4<td>1.7<tr><td>2002<td>2.9<td>3.6<tr><td>2000<td>NaN<td>1.5</table></div><blockquote class="prompt-info"><div><p>Note: In addition to being array-like, an Index also behaves like a fixed size set</p></div></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">frame3</span><span class="p">.</span><span class="n">columns</span>
<span class="n">Output</span><span class="p">:</span> <span class="n">Index</span><span class="p">([</span><span class="s">'Nevada'</span><span class="p">,</span> <span class="s">'Ohio'</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'object'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'state'</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="s">'Ohio'</span> <span class="ow">in</span> <span class="n">frame3</span><span class="p">.</span><span class="n">columns</span>
<span class="n">Output</span><span class="p">:</span> <span class="bp">True</span>

<span class="mi">2003</span> <span class="ow">in</span> <span class="n">frame3</span><span class="p">.</span><span class="n">index</span>
<span class="n">Output</span><span class="p">:</span> <span class="bp">False</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>Note: Unlike python sets, a pandas Index can contain duplicate labels</p></div></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">dup_labels</span>  <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Index</span><span class="p">([</span><span class="s">'foo'</span><span class="p">,</span> <span class="s">'foo'</span><span class="p">,</span> <span class="s">'bar'</span><span class="p">,</span> <span class="s">'bar'</span><span class="p">])</span>

<span class="n">dup_labels</span>
<span class="n">Output</span><span class="p">:</span> <span class="n">Index</span><span class="p">([</span><span class="s">'foo'</span><span class="p">,</span> <span class="s">'foo'</span><span class="p">,</span> <span class="s">'bar'</span><span class="p">,</span> <span class="s">'bar'</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s">'object'</span><span class="p">)</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>But selections with duplicate labels will select all occurences of that label.</p></div></blockquote><p>Each Index has a numer of methods and properteis for set logic, which answer other common questions about the data it contains.</p><p><img data-src="/assets/img/index_methods.png" alt="img" data-proofer-ignore></p><h2 id="essential-functionality"><span class="mr-2">Essential Functionality</span><a href="#essential-functionality" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><strong>Reindexing</strong> - An important method on pandas objects is <code class="language-plaintext highlighter-rouge">reindex</code>, which means to create a new object with the data conformed to a new index.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">7.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.3</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">],</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'d'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">])</span>
<span class="n">obj</span>

<span class="n">Output</span><span class="p">:</span>
    <span class="n">d</span>    <span class="mf">4.5</span>
    <span class="n">b</span>    <span class="mf">7.2</span>
    <span class="n">a</span>   <span class="o">-</span><span class="mf">5.3</span>
    <span class="n">c</span>    <span class="mf">3.6</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>Calling <code class="language-plaintext highlighter-rouge">reindex</code> on the above Series rearranges the data according to the new index, introducing missing values if any index values were not already present.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">obj2</span> <span class="o">=</span> <span class="n">obj</span><span class="p">.</span><span class="n">reindex</span><span class="p">([</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'d'</span><span class="p">,</span> <span class="s">'e'</span><span class="p">])</span>
<span class="n">obj2</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>   <span class="o">-</span><span class="mf">5.3</span>
    <span class="n">b</span>    <span class="mf">7.2</span>
    <span class="n">c</span>    <span class="mf">3.6</span>
    <span class="n">d</span>    <span class="mf">4.5</span>
    <span class="n">e</span>    <span class="n">NaN</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>Note: For ordered data like time series, it may be desirable to do some interpolation or filling of values when reindexing. The method option allows us to do this, using a method such as ffill, which forward-fills the values:</p></div></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="n">obj3</span>  <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="s">'blue'</span><span class="p">,</span> <span class="s">'purple'</span><span class="p">,</span> <span class="s">'yellow'</span><span class="p">],</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">0</span>      <span class="n">blue</span>
    <span class="mi">2</span>    <span class="n">purple</span>
    <span class="mi">4</span>    <span class="n">yellow</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">obj3</span><span class="p">.</span><span class="n">reindex</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">method</span> <span class="o">=</span> <span class="s">'ffill'</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span> 
    <span class="mi">0</span>      <span class="n">blue</span>
    <span class="mi">1</span>      <span class="n">blue</span>
    <span class="mi">2</span>    <span class="n">purple</span>
    <span class="mi">3</span>    <span class="n">purple</span>
    <span class="mi">4</span>    <span class="n">yellow</span>
    <span class="mi">5</span>    <span class="n">yellow</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>Note: With DataFrame, <code class="language-plaintext highlighter-rouge">reindex</code> can alter either the (row) index, columns or both. When passed only a sequence, it reindexed the rows in the result:</p></div></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">).</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'d'</span><span class="p">],</span>
                    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Ohio'</span><span class="p">,</span> <span class="s">'Texas'</span><span class="p">,</span> <span class="s">'California'</span><span class="p">])</span>
<span class="n">frame</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>Ohio<td>Texas<td>California<tr><td>a<td>0<td>1<td>2<tr><td>c<td>3<td>4<td>5<tr><td>d<td>6<td>7<td>8</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">frame2</span> <span class="o">=</span> <span class="n">frame</span><span class="p">.</span><span class="n">reindex</span><span class="p">([</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'d'</span><span class="p">])</span>
<span class="n">frame2</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>Ohio<td>Texas<td>California<tr><td>a<td>0<td>1<td>2<tr><td>b<td>NaN<td>NaN<td>NaN<tr><td>c<td>3<td>4<td>5<tr><td>d<td>6<td>7<td>8</table></div><p>The columns can be reindexed with the <code class="language-plaintext highlighter-rouge">columns</code> keyword</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">states</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Texas'</span><span class="p">,</span> <span class="s">'Utah'</span><span class="p">,</span> <span class="s">'California'</span><span class="p">]</span>

<span class="n">frame</span><span class="p">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">states</span><span class="p">)</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>Texas<td>Utah<td>California<tr><td>a<td>1<td>NaN<td>2<tr><td>c<td>4<td>NaN<td>5<tr><td>d<td>7<td>NaN<td>8</table></div><blockquote class="prompt-tip"><div><p>Note: We can reindex more succinctly by lable-indexing withloc, and this way is more preferable by many users.</p></div></blockquote><p><img data-src="/assets/img/reindex.png" alt="img" data-proofer-ignore></p><h2 id="dropping-entries-from-an-axis"><span class="mr-2">Dropping Entries from an Axis</span><a href="#dropping-entries-from-an-axis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Dropping one or more entries from an axis is easy if you already have an index array or list without those entries. As that can require a bit of munging and set logic, the drop method will return a new object with the indicated value or values deleted from an axis:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">5.</span><span class="p">),</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span><span class="s">'d'</span><span class="p">,</span> <span class="s">'e'</span><span class="p">])</span>
<span class="n">obj</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mf">0.0</span>
    <span class="n">b</span>    <span class="mf">1.0</span>
    <span class="n">c</span>    <span class="mf">2.0</span>
    <span class="n">d</span>    <span class="mf">3.0</span>
    <span class="n">e</span>    <span class="mf">4.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">new_obj</span> <span class="o">=</span> <span class="n">obj</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'c'</span><span class="p">)</span>
<span class="n">new_obj</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mf">0.0</span>
    <span class="n">b</span>    <span class="mf">1.0</span>
    <span class="n">d</span>    <span class="mf">3.0</span>
    <span class="n">e</span>    <span class="mf">4.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'d'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">])</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mf">0.0</span>
    <span class="n">b</span>    <span class="mf">1.0</span>
    <span class="n">e</span>    <span class="mf">4.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>With <code class="language-plaintext highlighter-rouge">DataFrame</code>, index values can be deleted from either axis.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">).</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>
                   <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Ohio'</span><span class="p">,</span> <span class="s">'Colorado'</span><span class="p">,</span> <span class="s">'Utah'</span><span class="p">,</span> <span class="s">'New York'</span><span class="p">],</span>
                   <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'one'</span><span class="p">,</span> <span class="s">'two'</span><span class="p">,</span> <span class="s">'three'</span><span class="p">,</span> <span class="s">'four'</span><span class="p">])</span>
<span class="n">data</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>one<td>two<td>three<td>four<tr><td>Ohio<td>0<td>1<td>2<td>3<tr><td>Colorado<td>4<td>5<td>6<td>7<tr><td>Utah<td>8<td>9<td>10<td>11<tr><td>New York<td>12<td>13<td>14<td>15</table></div><p>Calling <code class="language-plaintext highlighter-rouge">drop</code> with a sequence of lables will drop values from the row labels(<code class="language-plaintext highlighter-rouge">axis = 0</code>)</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">data</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'Colorado'</span><span class="p">,</span> <span class="s">'Ohio'</span><span class="p">])</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>one<td>two<td>three<td>four<tr><td>Utah<td>8<td>9<td>10<td>11<tr><td>New York<td>12<td>13<td>14<td>15</table></div><p>We can drop values from the columns by passing <code class="language-plaintext highlighter-rouge">axis = 1</code> or <code class="language-plaintext highlighter-rouge">axis = 'columns'</code></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">data</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'two'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>one<td>three<td>four<tr><td>Ohio<td>0<td>2<td>3<tr><td>Colorado<td>4<td>6<td>7<tr><td>Utah<td>8<td>10<td>11<tr><td>New York<td>12<td>14<td>15</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">data</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'three'</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="s">'columns'</span><span class="p">)</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>one<td>two<td>four<tr><td>Ohio<td>0<td>1<td>3<tr><td>Colorado<td>4<td>5<td>7<tr><td>Utah<td>8<td>9<td>11<tr><td>New York<td>12<td>13<td>15</table></div><p>Many functions like drop, which modify the size or shape of a Series or DataFrame, can manipulate an object in-place without returning a new object.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">obj</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'c'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">obj</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mf">0.0</span>
    <span class="n">b</span>    <span class="mf">1.0</span>
    <span class="n">d</span>    <span class="mf">3.0</span>
    <span class="n">e</span>    <span class="mf">4.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><blockquote><p>Note: Be careful with the inplace, as it destroys any data that is dropped.</p></blockquote><h2 id="indexing-selection-and-filtering"><span class="mr-2">Indexing, Selection, and Filtering</span><a href="#indexing-selection-and-filtering" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Series indexing (obj[…]) works analogously to NumPy array indexing, except you can use the Series’s index values instead of only integers.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">4.</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'a'</span><span class="p">,</span><span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span><span class="s">'d'</span><span class="p">])</span>
<span class="n">obj</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mf">0.0</span>
    <span class="n">b</span>    <span class="mf">1.0</span>
    <span class="n">c</span>    <span class="mf">2.0</span>
    <span class="n">d</span>    <span class="mf">3.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj</span><span class="p">[</span><span class="s">'b'</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span> <span class="mf">1.0</span>

<span class="n">obj</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span> <span class="mf">2.0</span>

<span class="n">obj</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">c</span>    <span class="mf">2.0</span>
    <span class="n">d</span>    <span class="mf">3.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj</span><span class="p">[[</span><span class="s">'b'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'d'</span><span class="p">]]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">b</span>    <span class="mf">1.0</span>
    <span class="n">a</span>    <span class="mf">0.0</span>
    <span class="n">d</span>    <span class="mf">3.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">b</span>    <span class="mf">1.0</span>
    <span class="n">d</span>    <span class="mf">3.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">obj</span><span class="p">[</span><span class="n">obj</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mf">0.0</span>
    <span class="n">b</span>    <span class="mf">1.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>Slicing with lables behaves differently than normal Python slicing in that the end-points are inclusive.</p></div></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">obj</span><span class="p">[</span><span class="s">'b'</span> <span class="p">:</span> <span class="s">'c'</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">b</span>    <span class="mf">1.0</span>
    <span class="n">c</span>    <span class="mf">2.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>Setting using these methods modifies the corresponding section of the Series</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">obj</span><span class="p">[</span><span class="s">'b'</span><span class="p">:</span><span class="s">'c'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">obj</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mf">0.0</span>
    <span class="n">b</span>    <span class="mf">5.0</span>
    <span class="n">c</span>    <span class="mf">5.0</span>
    <span class="n">d</span>    <span class="mf">3.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>Indexing into a DataFrame is for retrieving one or more columns either with a single vlaue or sequence</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">).</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>
                   <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Ohio'</span><span class="p">,</span> <span class="s">'Colorado'</span><span class="p">,</span> <span class="s">'Utah'</span><span class="p">,</span> <span class="s">'New York'</span><span class="p">],</span>
                   <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'one'</span><span class="p">,</span> <span class="s">'two'</span><span class="p">,</span> <span class="s">'three'</span><span class="p">,</span> <span class="s">'four'</span><span class="p">])</span>
<span class="n">data</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>one<td>two<td>three<td>four<tr><td>Ohio<td>0<td>1<td>2<td>3<tr><td>Colorado<td>4<td>5<td>6<td>7<tr><td>Utah<td>8<td>9<td>10<td>11<tr><td>New York<td>12<td>13<td>14<td>15</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">data</span><span class="p">[</span><span class="s">'two'</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">Ohio</span>         <span class="mi">1</span>
    <span class="n">Colorado</span>     <span class="mi">5</span>
    <span class="n">Utah</span>         <span class="mi">9</span>
    <span class="n">New</span> <span class="n">York</span>    <span class="mi">13</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">two</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">data</span> <span class="p">[[</span><span class="s">'three'</span><span class="p">,</span> <span class="s">'one'</span><span class="p">]]</span>
<span class="n">Output</span><span class="p">:</span>
              <span class="n">three</span>   <span class="n">one</span>
    <span class="n">Ohio</span>         <span class="mi">1</span>      <span class="mi">0</span>
    <span class="n">Colorado</span>     <span class="mi">5</span>      <span class="mi">4</span>
    <span class="n">Utah</span>         <span class="mi">9</span>      <span class="mi">8</span>
    <span class="n">New</span> <span class="n">York</span>    <span class="mi">13</span>      <span class="mi">12</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">two</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>
</pre></table></code></div></div><p>Indexing like this has a few special cases. First, slicing or selecting data with a boolean array:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">data</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>one<td>two<td>three<td>four<tr><td>Ohio<td>0<td>1<td>2<td>3<tr><td>Colorado<td>4<td>5<td>6<td>7</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">'three'</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">5</span><span class="p">]</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>one<td>two<td>three<td>four<tr><td>Ohio<td>0<td>1<td>2<td>3<tr><td>Colorado<td>4<td>5<td>6<td>7<tr><td>New York<td>12<td>13<td>14<td>15</table></div><p>The row selection syntax data[:2] is provided as a convenience. Passing a single element or a list to the [] operator selects columns.</p><p>Another use case is in indexing with a boolean DataFrame, such as one produced by a scalar comparision</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">data</span> 
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>one<td>two<td>three<td>four<tr><td>Ohio<td>0<td>1<td>2<td>3<tr><td>Colorado<td>4<td>5<td>6<td>7<tr><td>Utah<td>8<td>9<td>10<td>11<tr><td>New York<td>12<td>13<td>14<td>15</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">data</span> <span class="o">&lt;</span> <span class="mi">5</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>one<td>two<td>three<td>four<tr><td>Ohio<td>True<td>True<td>True<td>True<tr><td>Colorado<td>True<td>False<td>False<td>False<tr><td>Utah<td>False<td>False<td>False<td>False<tr><td>New York<td>False<td>False<td>False<td>False</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>one<td>two<td>three<td>four<tr><td>Ohio<td>0<td>0<td>0<td>0<tr><td>Colorado<td>0<td>5<td>6<td>7<tr><td>Utah<td>8<td>9<td>10<td>11<tr><td>New York<td>12<td>13<td>14<td>15</table></div><p>This makes DataFrame syntactically more like a two-dimensional NumPy array in this particular case.</p><h2 id="selection-with-loc-and-iloc"><span class="mr-2">Selection with loc and iloc</span><a href="#selection-with-loc-and-iloc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">data</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>one<td>two<td>three<td>four<tr><td>Ohio<td>0<td>0<td>0<td>0<tr><td>Colorado<td>0<td>5<td>6<td>7<tr><td>Utah<td>8<td>9<td>10<td>11<tr><td>New York<td>12<td>13<td>14<td>15</table></div><p>The special indexing operators <code class="language-plaintext highlighter-rouge">loc</code> and <code class="language-plaintext highlighter-rouge">iloc</code> enables us to select a subset of rows and columns from a DataFrame with NumPy-like notation using either axis labels(loc) or integers (iloc)</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="n">data</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'Colorado'</span><span class="p">,</span> <span class="p">[</span><span class="s">'two'</span><span class="p">,</span> <span class="s">'three'</span><span class="p">]]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">two</span>      <span class="mi">5</span>
    <span class="n">three</span>    <span class="mi">6</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">Colorado</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>

<span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">four</span>    <span class="mi">11</span>
    <span class="n">one</span>      <span class="mi">8</span>
    <span class="n">two</span>      <span class="mi">9</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">Utah</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>

<span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">one</span>       <span class="mi">8</span>
    <span class="n">two</span>       <span class="mi">9</span>
    <span class="n">three</span>    <span class="mi">10</span>
    <span class="n">four</span>     <span class="mi">11</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">Utah</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>four<td>one<td>tow<tr><td>Colorado<td>7<td>0<td>5<tr><td>Utah<td>11<td>8<td>9</table></div><p>Both indexing functions work with slices in addition to single labels or list of labels</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">data</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>one<td>two<td>three<td>four<tr><td>Ohio<td>0<td>0<td>0<td>0<tr><td>Colorado<td>0<td>5<td>6<td>7<tr><td>Utah<td>8<td>9<td>10<td>11<tr><td>New York<td>12<td>13<td>14<td>15</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">data</span><span class="p">.</span><span class="n">loc</span><span class="p">[:</span><span class="s">'Utah'</span><span class="p">,</span> <span class="s">'two'</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">Ohio</span>        <span class="mi">0</span>
    <span class="n">Colorado</span>    <span class="mi">5</span>
    <span class="n">Utah</span>        <span class="mi">9</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">two</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int32</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">][</span><span class="n">data</span><span class="p">[</span><span class="s">'three'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">]</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>one<td>two<td>three<tr><td>Colorado<td>0<td>5<td>6<tr><td>Utah<td>8<td>9<td>10<tr><td>New York<td>12<td>13<td>14</table></div><p><img data-src="/assets/img/index_options1.png" alt="img" data-proofer-ignore> <img data-src="/assets/img/index_options2.png" alt="img" data-proofer-ignore></p><h2 id="integer-indexes"><span class="mr-2">Integer Indexes</span><a href="#integer-indexes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">3.</span><span class="p">))</span>
<span class="n">ser</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">0</span>    <span class="mf">0.0</span>
    <span class="mi">1</span>    <span class="mf">1.0</span>
    <span class="mi">2</span>    <span class="mf">2.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="n">ser2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">3.</span><span class="p">),</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">])</span>
<span class="n">ser2</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mf">0.0</span>
    <span class="n">b</span>    <span class="mf">1.0</span>
    <span class="n">c</span>    <span class="mf">2.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">ser2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span> <span class="mf">2.0</span>

<span class="n">ser</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">0</span>    <span class="mf">0.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">ser</span><span class="p">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">0</span>    <span class="mf">0.0</span>
    <span class="mi">1</span>    <span class="mf">1.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">ser</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">0</span>    <span class="mf">0.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><h2 id="arithmetic-and-data-alignment"><span class="mr-2">Arithmetic and Data Alignment</span><a href="#arithmetic-and-data-alignment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>An important pandas feature for some applications is the behavior of arithmetic between objects with different indexes. When you are adding together objects, if any index pairs are not the same, the respective index in the result will be the union of the index paris. For users with database experience, this is similar to an automatic <code class="language-plaintext highlighter-rouge">Outer Join</code> on the index labels.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="n">s1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">7.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'d'</span><span class="p">,</span> <span class="s">'e'</span><span class="p">])</span>

<span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="o">-</span><span class="mf">2.1</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">],</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'e'</span><span class="p">,</span> <span class="s">'f'</span><span class="p">,</span> <span class="s">'g'</span><span class="p">])</span>

<span class="n">s1</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mf">7.3</span>
    <span class="n">c</span>   <span class="o">-</span><span class="mf">2.5</span>
    <span class="n">d</span>    <span class="mf">3.4</span>
    <span class="n">e</span>    <span class="mf">1.5</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">s2</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>   <span class="o">-</span><span class="mf">2.1</span>
    <span class="n">c</span>    <span class="mf">3.6</span>
    <span class="n">e</span>   <span class="o">-</span><span class="mf">1.5</span>
    <span class="n">f</span>    <span class="mf">4.0</span>
    <span class="n">g</span>    <span class="mf">3.1</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">s1</span> <span class="o">+</span> <span class="n">s2</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mf">5.2</span>
    <span class="n">c</span>    <span class="mf">1.1</span>
    <span class="n">d</span>    <span class="n">NaN</span>
    <span class="n">e</span>    <span class="mf">0.0</span>
    <span class="n">f</span>    <span class="n">NaN</span>
    <span class="n">g</span>    <span class="n">NaN</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>Here, the internal data alignment introduces missing values in the label locations that don’t overlap. Missing values will then propagate in further arithmetic computations.</p><p>In case of DataFrame, alignment is performed on both the rows and the columns</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">9.</span><span class="p">).</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>
                  <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s">'bcd'</span><span class="p">),</span> 
                  <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Ohio'</span><span class="p">,</span> <span class="s">'Texas'</span><span class="p">,</span> <span class="s">'Colorado'</span><span class="p">])</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">12.</span><span class="p">).</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>
                  <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s">'bde'</span><span class="p">),</span>
                  <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Utah'</span><span class="p">,</span> <span class="s">'Ohio'</span><span class="p">,</span> <span class="s">'Texas'</span><span class="p">,</span> <span class="s">'Oregon'</span><span class="p">])</span>

<span class="n">df1</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>b<td>c<td>d<tr><td>Ohio<td>0.0<td>1.0<td>2.0<tr><td>Texas<td>3.0<td>4.0<td>5.0<tr><td>Colorado<td>6.0<td>7.0<td>8.0</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>  <span class="n">df2</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>b<td>d<td>e<tr><td>Ohio<td>0.0<td>1.0<td>2.0<tr><td>Texas<td>3.0<td>4.0<td>5.0<tr><td>Colorado<td>6.0<td>7.0<td>8.0<tr><td>Oregon<td>9.0<td>10.0<td>11.0</table></div><p>Adding these together returns a DataFrame whose index and columns are the unionis of the ones in each DataFrame</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">df1</span> <span class="o">+</span> <span class="n">df2</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>b<td>c<td>d<td>e<tr><td>Colorado<td>NaN<td>NaN<td>NaN<td>NaN<tr><td>Ohio<td>3.0<td>NaN<td>6.0<td>NaN<tr><td>Oregon<td>NaN<td>NaN<td>NaN<td>NaN<tr><td>Texas<td>9.0<td>NaN<td>12.0<td>NaN<tr><td>Utah<td>NaN<td>NaN<td>NaN<td>NaN</table></div><p>Since, the ‘c’ and ‘e’ columns are note present in bothe the DataFrame objects, they appears as all missing in the result. The same holds for the ‘Utah’, ‘Colorado’, and ‘Oregon’ whose labels are not common to both objects.</p><blockquote><p>Note: If you add DataFrame objects with no column or row labels in common, then the result will contain all nulls:</p></blockquote><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'A'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]})</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'B'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]})</span>

<span class="n">df1</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">A</span>
  <span class="mi">0</span> <span class="mi">1</span>
  <span class="mi">1</span> <span class="mi">2</span>

<span class="n">df2</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">B</span>
  <span class="mi">0</span> <span class="mi">3</span>
  <span class="mi">1</span> <span class="mi">4</span>

<span class="n">df1</span> <span class="o">-</span> <span class="n">df2</span>
      <span class="n">A</span>   <span class="n">B</span>
  <span class="mi">0</span> <span class="n">NaN</span> <span class="n">NaN</span>
  <span class="mi">1</span> <span class="n">NaN</span> <span class="n">NaN</span>
</pre></table></code></div></div><h2 id="arithmetic-methods-with-fill-values"><span class="mr-2">Arithmetic methods with fill values</span><a href="#arithmetic-methods-with-fill-values" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>In arithmetic operations between differently indexed objects, you might want to fill with a special value, like 0, when an axis lable is found in one object but not the other</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">12.</span><span class="p">).</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>
                  <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s">'abcd'</span><span class="p">))</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">20.</span><span class="p">).</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)),</span> 
                  <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s">'abcde'</span><span class="p">))</span>
<span class="n">df2</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s">'b'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">df1</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>a<td>b<td>c<td>d<tr><td>0<td>0.0<td>1.0<td>2.0<td>3.0<tr><td>1<td>4.0<td>5.0<td>6.0<td>7.0<tr><td>2<td>8.0<td>9.0<td>10.0<td>11.0</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">df2</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>a<td>b<td>c<td>d<td>e<tr><td>0<td>0.0<td>1.0<td>2.0<td>3.0<td>4.0<tr><td>1<td>5.0<td>NaN<td>7.0<td>8.0<td>9.0<tr><td>2<td>10.0<td>11.0<td>12.0<td>13.0<td>14.0<tr><td>3<td>15.0<td>16.0<td>17.0<td>18.0<td>19.0</table></div><p>Adding these together results in NA values in the locations that don’t overlap:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">df1</span> <span class="o">+</span> <span class="n">df2</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>a<td>b<td>c<td>d<td>e<tr><td>0<td>0.0<td>2.0<td>4.0<td>6.0<td>NaN<tr><td>1<td>9.0<td>NaN<td>13.0<td>15.0<td>NaN<tr><td>2<td>18.0<td>20.0<td>22.0<td>24.0<td>NaN<tr><td>3<td>NaN<td>NaN<td>NaN<td>NaN<td>NaN</table></div><p>Using the <code class="language-plaintext highlighter-rouge">add method</code> on df1,we can pass df2 and an arguemnt to fill_value</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">df1</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">fill_value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>a<td>b<td>c<td>d<td>e<tr><td>0<td>0.0<td>2.0<td>4.0<td>6.0<td>4.0<tr><td>1<td>9.0<td>5..0<td>13.0<td>15.0<td>9.0<tr><td>2<td>18.0<td>20.0<td>22.0<td>24.0<td>14.0<tr><td>3<td>15.0<td>16.0<td>17.0<td>18.0<td>19.0</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">df1</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>a<td>b<td>c<td>d<tr><td>0<td>0.0<td>1.0<td>2.0<td>3.0<tr><td>1<td>4.0<td>5.0<td>6.0<td>7.0<tr><td>2<td>8.0<td>9.0<td>10.0<td>11.0</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="mi">1</span><span class="o">/</span><span class="n">df1</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>a<td>b<td>c<td>d<tr><td>0<td>inf<td>1.000000<td>0.500000<td>0.333333<tr><td>1<td>0.250000<td>0.200000<td>0.166667<td>0.142857<tr><td>2<td>0.125000<td>0.111111<td>0.100000<td>0.090909</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">df1</span><span class="p">.</span><span class="n">rdiv</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>a<td>b<td>c<td>d<tr><td>0<td>inf<td>1.000000<td>0.500000<td>0.333333<tr><td>1<td>0.250000<td>0.200000<td>0.166667<td>0.142857<tr><td>2<td>0.125000<td>0.111111<td>0.100000<td>0.090909</table></div><p>When reindxing a Series or DataFrame, we can speciy a different fill value</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">df1</span><span class="p">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df2</span><span class="p">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>a<td>b<td>c<td>d<td>e<tr><td>0<td>0.0<td>1.0<td>2.0<td>3.0<td>0<tr><td>1<td>4.0<td>5.0<td>6.0<td>7.0<td>0<tr><td>2<td>8.0<td>9.0<td>10.0<td>11.0<td>0</table></div><p><img data-src="/assets/img/arithmetic_methods.png" alt="img" data-proofer-ignore></p><h2 id="operations-between-dataframe-and-series"><span class="mr-2">Operations between DataFrame and Series</span><a href="#operations-between-dataframe-and-series" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">12.</span><span class="p">).</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">arr</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">2.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">],</span>
           <span class="p">[</span> <span class="mf">4.</span><span class="p">,</span>  <span class="mf">5.</span><span class="p">,</span>  <span class="mf">6.</span><span class="p">,</span>  <span class="mf">7.</span><span class="p">],</span>
           <span class="p">[</span> <span class="mf">8.</span><span class="p">,</span>  <span class="mf">9.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">11.</span><span class="p">]])</span>

<span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">])</span>

<span class="n">arr</span> <span class="o">-</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
           <span class="p">[</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span>
           <span class="p">[</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">]])</span>
</pre></table></code></div></div><p>Here, when we subtract arr[0] from arr, the subtraction is performed once for each row. This is referred to as <code class="language-plaintext highlighter-rouge">broadcasting</code>.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">12.</span><span class="p">).</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span>
                    <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s">'bde'</span><span class="p">),</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Utah'</span><span class="p">,</span> <span class="s">'Ohio'</span><span class="p">,</span> <span class="s">'Teas'</span><span class="p">,</span> <span class="s">'Oregon'</span><span class="p">])</span>
<span class="n">series</span> <span class="o">=</span> <span class="n">frame</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">frame</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>b<td>d<td>e<tr><td>Utah<td>0.0<td>1.0<td>2.0<tr><td>Ohio<td>3.0<td>4.0<td>5.0<tr><td>Texas<td>6.0<td>7.0<td>8.0<tr><td>Oregon<td>9.0<td>10.0<td>11.0</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">series</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">b</span>    <span class="mf">0.0</span>
    <span class="n">d</span>    <span class="mf">1.0</span>
    <span class="n">e</span>    <span class="mf">2.0</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">Utah</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>By default, arithmetic between a DataFrame and Series matches the index of the Series on the DataFrame’s columns, broadcasting down the rows</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">frame</span> <span class="o">-</span> <span class="n">series</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>b<td>d<td>e<tr><td>Utah<td>0.0<td>0.0<td>0.0<tr><td>Ohio<td>3.0<td>3.0<td>3.0<tr><td>Texas<td>6.0<td>6.0<td>6.0<tr><td>Oregon<td>9.0<td>9.0<td>9.0</table></div><p>If an index value is not found in either the DataFrame’s columns or the Series’s index, then the objects will be reindexed to form the union</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">series2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'b'</span><span class="p">,</span> <span class="s">'e'</span><span class="p">,</span> <span class="s">'f'</span><span class="p">])</span>
<span class="n">frame</span> <span class="o">+</span> <span class="n">series2</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>b<td>d<td>e<td>f<tr><td>Utah<td>0.0<td>NaN<td>3.0<td>NaN<tr><td>Ohio<td>3.0<td>NaN<td>6.0<td>NaN<tr><td>Texas<td>6.0<td>NaN<td>9.0<td>NaN<tr><td>Oregon<td>9.0<td>NaN<td>12.0<td>NaN</table></div><p>If we want to instead broadcast over the columns, matching on the rows, we have to use one of the arithmetic methods</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">frame</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>b<td>d<td>e<tr><td>Utah<td>0.0<td>1.0<td>2.0<tr><td>Ohio<td>3.0<td>4.0<td>5.0<tr><td>Texas<td>6.0<td>7.0<td>8.0<tr><td>Oregon<td>9.0<td>10.0<td>11.0</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">series3</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s">'d'</span><span class="p">]</span>
<span class="n">series3</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">Utah</span>       <span class="mf">1.0</span>
    <span class="n">Ohio</span>       <span class="mf">4.0</span>
    <span class="n">Teas</span>       <span class="mf">7.0</span>
    <span class="n">Oregon</span>    <span class="mf">10.0</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">d</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">frame</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="n">series3</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="s">'index'</span><span class="p">)</span>
</pre></table></code></div></div><p>Output:</p><div class="table-wrapper"><table><tbody><tr><td> <td>b<td>d<td>e<tr><td>Utah<td>-1.0<td>0.0<td>1.0<tr><td>Ohio<td>-1.0<td>0.0<td>1.0<tr><td>Texas<td>-1.0<td>0.0<td>1.0<tr><td>Oregon<td>-1.0<td>0.0<td>1.0</table></div><p>The axis number that we pass is the axis to mathc on. In this case we mean to match on the DataFrame’s row index (axis=’index’ or axis= 0) and broadcast across the columns.</p><h2 id="function-application-and-mapping"><span class="mr-2">Function Application and Mapping</span><a href="#function-application-and-mapping" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Numpy ufuncs (element-wise array methods) also work with pandas objects</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> 
                    <span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s">'bde'</span><span class="p">),</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Utah'</span><span class="p">,</span> <span class="s">'Ohio'</span><span class="p">,</span> <span class="s">'Texas'</span><span class="p">,</span> <span class="s">'Oregon'</span><span class="p">])</span>
<span class="n">frame</span>

<span class="n">Output</span><span class="p">:</span>
	        <span class="n">b</span>	        <span class="n">d</span>       	<span class="n">e</span>
<span class="n">Utah</span>	<span class="o">-</span><span class="mf">0.059728</span>	<span class="o">-</span><span class="mf">1.671352</span>	<span class="o">-</span><span class="mf">2.322987</span>
<span class="n">Ohio</span>	<span class="o">-</span><span class="mf">1.072084</span>	<span class="o">-</span><span class="mf">1.265158</span>	<span class="o">-</span><span class="mf">1.452127</span>
<span class="n">Texas</span>	<span class="o">-</span><span class="mf">1.487410</span>	<span class="o">-</span><span class="mf">2.289852</span>	<span class="o">-</span><span class="mf">1.427222</span>
<span class="n">Oregon</span>	<span class="o">-</span><span class="mf">0.852068</span>	<span class="o">-</span><span class="mf">0.911926</span>	<span class="mf">0.486711</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">np</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>
	        <span class="n">b</span>	        <span class="n">d</span>	        <span class="n">e</span>
<span class="n">Utah</span>	<span class="mf">0.059728</span>	<span class="mf">1.671352</span>	<span class="mf">2.322987</span>
<span class="n">Ohio</span>	<span class="mf">1.072084</span>	<span class="mf">1.265158</span>	<span class="mf">1.452127</span>
<span class="n">Texas</span>	<span class="mf">1.487410</span>	<span class="mf">2.289852</span>	<span class="mf">1.427222</span>
<span class="n">Oregon</span>	<span class="mf">0.852068</span>	<span class="mf">0.911926</span>	<span class="mf">0.486711</span>
</pre></table></code></div></div><p><strong>Another frequent operation is applying a function on one-dimensional arrays to each column or row. DataFrame’s <code class="language-plaintext highlighter-rouge">apply</code> method does exactly this.</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">.</span><span class="nb">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">x</span><span class="p">.</span><span class="nb">min</span><span class="p">()</span>
<span class="n">frame</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">b</span>    <span class="mf">1.427681</span>
    <span class="n">d</span>    <span class="mf">1.377926</span>
    <span class="n">e</span>    <span class="mf">2.809697</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>Here, the function f, which computes the difference between the maximum and minimum of a Series, is invoked once on each column in frame. The result is a Series having the columns of frame as its index.</p><p>If we pass <code class="language-plaintext highlighter-rouge">axis = 'columns'</code> to apply, the function will be invoked once per row instead</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">frame</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="s">'columns'</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">Utah</span>      <span class="mf">2.263259</span>
    <span class="n">Ohio</span>      <span class="mf">0.380044</span>
    <span class="n">Texas</span>     <span class="mf">0.862630</span>
    <span class="n">Oregon</span>    <span class="mf">1.398637</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>Many of the most common array statistics (like sum and mean) are DataFrame methods so using <code class="language-plaintext highlighter-rouge">apply</code> is not necessary.</p><p>The function passed to apply need not return a scalar value, it can also return a Series with multiple values. For example:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="n">x</span><span class="p">.</span><span class="nb">min</span><span class="p">(),</span><span class="n">x</span><span class="p">.</span><span class="nb">max</span><span class="p">()],</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'min'</span><span class="p">,</span> <span class="s">'max'</span><span class="p">])</span>
<span class="n">frame</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">Output</span><span class="p">:</span>
        <span class="n">b</span>	         <span class="n">d</span>	       <span class="n">e</span>
<span class="nb">min</span>	<span class="o">-</span><span class="mf">1.487410</span>	<span class="o">-</span><span class="mf">2.289852</span>	<span class="o">-</span><span class="mf">2.322987</span>
<span class="nb">max</span>	<span class="o">-</span><span class="mf">0.059728</span>	<span class="o">-</span><span class="mf">0.911926</span>	<span class="mf">0.486711</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">frame</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="s">'columns'</span><span class="p">)</span>

<span class="n">Output</span><span class="p">:</span>
          <span class="nb">min</span>     	<span class="nb">max</span>
<span class="n">Utah</span>	<span class="o">-</span><span class="mf">2.322987</span>	<span class="o">-</span><span class="mf">0.059728</span>
<span class="n">Ohio</span>	<span class="o">-</span><span class="mf">1.452127</span>	<span class="o">-</span><span class="mf">1.072084</span>
<span class="n">Texas</span>	<span class="o">-</span><span class="mf">2.289852</span>	<span class="o">-</span><span class="mf">1.427222</span>
<span class="n">Oregon</span>	<span class="o">-</span><span class="mf">0.911926</span>	<span class="mf">0.486711</span>
</pre></table></code></div></div><p>Element wise python functions can be used, too. Suppose, you wanted to compute a formatted string from each floating-point value in frame. You can do this with <code class="language-plaintext highlighter-rouge">applymap</code></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nb">format</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">'%2f'</span> <span class="o">%</span> <span class="n">x</span>
<span class="n">frame</span><span class="p">.</span><span class="n">applymap</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>

<span class="n">Output</span><span class="p">:</span>
        <span class="n">b</span>         <span class="n">d</span>         <span class="n">e</span>
<span class="n">Utah</span>	<span class="o">-</span><span class="mf">0.059728</span>	<span class="o">-</span><span class="mf">1.671352</span>	<span class="o">-</span><span class="mf">2.322987</span>
<span class="n">Ohio</span>	<span class="o">-</span><span class="mf">1.072084</span>	<span class="o">-</span><span class="mf">1.265158</span>	<span class="o">-</span><span class="mf">1.452127</span>
<span class="n">Texas</span>	<span class="o">-</span><span class="mf">1.487410</span>	<span class="o">-</span><span class="mf">2.289852</span>	<span class="o">-</span><span class="mf">1.427222</span>
<span class="n">Oregon</span>	<span class="o">-</span><span class="mf">0.852068</span>	<span class="o">-</span><span class="mf">0.911926</span>	<span class="mf">0.486711</span>
</pre></table></code></div></div><p>The reason for the name <code class="language-plaintext highlighter-rouge">applymap</code> is that Series has a <code class="language-plaintext highlighter-rouge">map</code> method for applying an element-wise function</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">frame</span><span class="p">[</span><span class="s">'e'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">Utah</span>      <span class="o">-</span><span class="mf">2.322987</span>
    <span class="n">Ohio</span>      <span class="o">-</span><span class="mf">1.452127</span>
    <span class="n">Texas</span>     <span class="o">-</span><span class="mf">1.427222</span>
    <span class="n">Oregon</span>     <span class="mf">0.486711</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">e</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></table></code></div></div><h2 id="sorting-and-ranking"><span class="mr-2">Sorting and Ranking</span><a href="#sorting-and-ranking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Sorting a dataset by some criterion is another important built-in operation. To sort lexicographically by row or column index, use the <code class="language-plaintext highlighter-rouge">sort_index</code> method, which returns a new, sorted object</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'d'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span><span class="s">'b'</span><span class="p">,</span><span class="s">'c'</span><span class="p">])</span>
<span class="n">obj</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">d</span>    <span class="mi">0</span>
    <span class="n">a</span>    <span class="mi">1</span>
    <span class="n">b</span>    <span class="mi">2</span>
    <span class="n">c</span>    <span class="mi">3</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">obj</span><span class="p">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mi">1</span>
    <span class="n">b</span>    <span class="mi">2</span>
    <span class="n">c</span>    <span class="mi">3</span>
    <span class="n">d</span>    <span class="mi">0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></table></code></div></div><p>With a DataFrame, we can sort by index on either axis</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">8</span><span class="p">).</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)),</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'three'</span><span class="p">,</span> <span class="s">'one'</span><span class="p">],</span>
                    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'d'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">])</span>
<span class="n">frame</span>

<span class="n">Output</span><span class="p">:</span>
	<span class="n">d</span>	<span class="n">a</span>	<span class="n">b</span>	<span class="n">c</span>
<span class="n">three</span>	<span class="mi">0</span>	<span class="mi">1</span>	<span class="mi">2</span>	<span class="mi">3</span>
<span class="n">one</span>	<span class="mi">4</span>	<span class="mi">5</span>	<span class="mi">6</span>	<span class="mi">7</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">frame</span><span class="p">.</span><span class="n">sort_index</span><span class="p">()</span>

<span class="n">Output</span><span class="p">:</span>
	<span class="n">d</span>	<span class="n">a</span>	<span class="n">b</span>	<span class="n">c</span>
<span class="n">one</span>	<span class="mi">4</span>	<span class="mi">5</span>	<span class="mi">6</span>	<span class="mi">7</span>
<span class="n">three</span>	<span class="mi">0</span>	<span class="mi">1</span>	<span class="mi">2</span>	<span class="mi">3</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">frame</span><span class="p">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">Output</span><span class="p">:</span>
	<span class="n">a</span>	<span class="n">b</span>	<span class="n">c</span>	<span class="n">d</span>
<span class="n">three</span>	<span class="mi">1</span>	<span class="mi">2</span>	<span class="mi">3</span>	<span class="mi">0</span>
<span class="n">one</span>	<span class="mi">5</span>	<span class="mi">6</span>	<span class="mi">7</span>	<span class="mi">4</span>
</pre></table></code></div></div><p>The data is sorted in ascending order by default, but can be sorted in descending order too using the ascending attribute</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">frame</span><span class="p">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">Output</span><span class="p">:</span>
	<span class="n">d</span>	<span class="n">c</span>	<span class="n">b</span>	<span class="n">a</span>
<span class="n">three</span>	<span class="mi">0</span>	<span class="mi">3</span>	<span class="mi">2</span>	<span class="mi">1</span>
<span class="n">one</span>	<span class="mi">4</span>	<span class="mi">7</span>	<span class="mi">6</span>	<span class="mi">5</span>
</pre></table></code></div></div><p>To sort a Series by its values, use it’s sort_values method</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">obj</span><span class="p">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">2</span>   <span class="o">-</span><span class="mi">3</span>
    <span class="mi">3</span>    <span class="mi">2</span>
    <span class="mi">0</span>    <span class="mi">4</span>
    <span class="mi">1</span>    <span class="mi">7</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></table></code></div></div><p>Any missing values are sorted to the end of the Series by default</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">obj</span><span class="p">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">4</span>   <span class="o">-</span><span class="mf">3.0</span>
    <span class="mi">5</span>    <span class="mf">2.0</span>
    <span class="mi">0</span>    <span class="mf">4.0</span>
    <span class="mi">2</span>    <span class="mf">7.0</span>
    <span class="mi">1</span>    <span class="n">NaN</span>
    <span class="mi">3</span>    <span class="n">NaN</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>When sorting a DataFrame, we can use the data in one or more columns as the sort keys.To do so, pass one or more columns names to the by option of sort_values</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'b'</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,],</span> <span class="s">'a'</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
<span class="n">frame</span>
<span class="n">Output</span><span class="p">:</span>
	<span class="n">b</span>	<span class="n">a</span>
<span class="mi">0</span>	<span class="mi">4</span>	<span class="mi">0</span>
<span class="mi">1</span>	<span class="mi">7</span>	<span class="mi">1</span>
<span class="mi">2</span>	<span class="o">-</span><span class="mi">3</span>	<span class="mi">0</span>
<span class="mi">3</span>	<span class="mi">2</span>	<span class="mi">1</span>

<span class="n">frame</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'a'</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>
	<span class="n">b</span>	<span class="n">a</span>
<span class="mi">0</span>	<span class="mi">4</span>	<span class="mi">0</span>
<span class="mi">2</span>	<span class="o">-</span><span class="mi">3</span>	<span class="mi">0</span>
<span class="mi">1</span>	<span class="mi">7</span>	<span class="mi">1</span>
<span class="mi">3</span>	<span class="mi">2</span>	<span class="mi">1</span>
</pre></table></code></div></div><p>To sort by multiple columns, pass a list of name</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">frame</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">])</span>

<span class="n">Output</span><span class="p">:</span>
	<span class="n">b</span>	<span class="n">a</span>
<span class="mi">2</span>	<span class="o">-</span><span class="mi">3</span>	<span class="mi">0</span>
<span class="mi">0</span>	<span class="mi">4</span>	<span class="mi">0</span>
<span class="mi">3</span>	<span class="mi">2</span>	<span class="mi">1</span>
<span class="mi">1</span>	<span class="mi">7</span>	<span class="mi">1</span>
</pre></table></code></div></div><p><strong>Ranking</strong> assigns ranks from one through the number of valid data points in an array. The <code class="language-plaintext highlighter-rouge">rank</code> methods for Series and DataFrame are the place to look; by default <code class="language-plaintext highlighter-rouge">rank</code> breaks ties by assinging each group the mean rank</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">obj</span><span class="p">.</span><span class="n">rank</span><span class="p">()</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">0</span>    <span class="mf">6.5</span>
    <span class="mi">1</span>    <span class="mf">1.0</span>
    <span class="mi">2</span>    <span class="mf">6.5</span>
    <span class="mi">3</span>    <span class="mf">4.5</span>
    <span class="mi">4</span>    <span class="mf">3.0</span>
    <span class="mi">5</span>    <span class="mf">2.0</span>
    <span class="mi">6</span>    <span class="mf">4.5</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>Ranks can also be assigned according to the order in which they’re observed in the data</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="n">obj</span><span class="p">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">'first'</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">0</span>    <span class="mf">6.0</span>
    <span class="mi">1</span>    <span class="mf">1.0</span>
    <span class="mi">2</span>    <span class="mf">7.0</span>
    <span class="mi">3</span>    <span class="mf">4.0</span>
    <span class="mi">4</span>    <span class="mf">3.0</span>
    <span class="mi">5</span>    <span class="mf">2.0</span>
    <span class="mi">6</span>    <span class="mf">5.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>Here, instead of using the average rank 6.5 for the entries 0 and 2, they instead have been set ot 6 and 7 because label 0 precedes label 2 in the data.</p><p>We can rank in descending order too</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="n">obj</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">0</span>    <span class="mi">7</span>
    <span class="mi">1</span>   <span class="o">-</span><span class="mi">5</span>
    <span class="mi">2</span>    <span class="mi">7</span>
    <span class="mi">3</span>    <span class="mi">4</span>
    <span class="mi">4</span>    <span class="mi">2</span>
    <span class="mi">5</span>    <span class="mi">0</span>
    <span class="mi">6</span>    <span class="mi">4</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">obj</span><span class="p">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s">'max'</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">0</span>    <span class="mf">2.0</span>
    <span class="mi">1</span>    <span class="mf">7.0</span>
    <span class="mi">2</span>    <span class="mf">2.0</span>
    <span class="mi">3</span>    <span class="mf">4.0</span>
    <span class="mi">4</span>    <span class="mf">5.0</span>
    <span class="mi">5</span>    <span class="mf">6.0</span>
    <span class="mi">6</span>    <span class="mf">4.0</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>DataFrame can compute ranks over the rows or the columns</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="n">frame</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'b'</span><span class="p">:</span> <span class="p">[</span><span class="mf">4.3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="s">'a'</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                     <span class="s">'c'</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mf">2.5</span><span class="p">]})</span>
<span class="n">frame</span>

<span class="n">Output</span><span class="p">:</span>
	<span class="n">b</span>	<span class="n">a</span>	<span class="n">c</span>
<span class="mi">0</span>	<span class="mf">4.3</span>	<span class="mi">0</span>	<span class="o">-</span><span class="mf">2.0</span>
<span class="mi">1</span>	<span class="mf">7.0</span>	<span class="mi">1</span>	<span class="mf">5.0</span>
<span class="mi">2</span>	<span class="o">-</span><span class="mf">3.0</span>	<span class="mi">0</span>	<span class="mf">8.0</span>
<span class="mi">3</span>	<span class="mf">2.0</span>	<span class="mi">1</span>	<span class="o">-</span><span class="mf">2.5</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">frame</span><span class="p">.</span><span class="n">rank</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'columns'</span><span class="p">)</span>

<span class="n">Output</span><span class="p">:</span>
	<span class="n">b</span>	<span class="n">a</span>	<span class="n">c</span>
<span class="mi">0</span>	<span class="mf">3.0</span>	<span class="mf">2.0</span>	<span class="mf">1.0</span>
<span class="mi">1</span>	<span class="mf">3.0</span>	<span class="mf">1.0</span>	<span class="mf">2.0</span>
<span class="mi">2</span>	<span class="mf">1.0</span>	<span class="mf">2.0</span>	<span class="mf">3.0</span>
<span class="mi">3</span>	<span class="mf">3.0</span>	<span class="mf">2.0</span>	<span class="mf">1.0</span>
</pre></table></code></div></div><p><img data-src="/assets/img/rank.png" alt="img" data-proofer-ignore></p><h2 id="axis-indexes-with-duplicate-labels"><span class="mr-2">Axis Indexes with Duplicate Labels</span><a href="#axis-indexes-with-duplicate-labels" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span><span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">])</span>
<span class="n">obj</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mi">0</span>
    <span class="n">a</span>    <span class="mi">1</span>
    <span class="n">b</span>    <span class="mi">2</span>
    <span class="n">b</span>    <span class="mi">3</span>
    <span class="n">c</span>    <span class="mi">4</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></table></code></div></div><p>The index’s <code class="language-plaintext highlighter-rouge">is_unique</code> property can tell you whether its labels are unique or not</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">obj</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">is_unique</span>
<span class="n">Output</span><span class="p">:</span> <span class="bp">False</span>
</pre></table></code></div></div><p>Data Selection is one of the main things that behaves differently with duplicates. Indexing a label with multiple entries returns a Series, while single entries return a scalar value.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">obj</span><span class="p">[</span><span class="s">'a'</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mi">0</span>
    <span class="n">a</span>    <span class="mi">1</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="n">obj</span><span class="p">[</span><span class="s">'c'</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span> <span class="mi">4</span>
</pre></table></code></div></div><p>This can make our code more complicated as the output type from indexing can vary based on whether a label is repeated or not.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> 
                 <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">])</span>
<span class="n">df</span>

<span class="n">Output</span><span class="p">:</span>
	<span class="mi">0</span>	<span class="mi">1</span>	<span class="mi">2</span>
<span class="n">a</span>	<span class="o">-</span><span class="mf">0.088814</span>	<span class="o">-</span><span class="mf">0.602398</span>	<span class="mf">0.402683</span>
<span class="n">a</span>	<span class="mf">1.195694</span>	<span class="o">-</span><span class="mf">0.383322</span>	<span class="mf">0.330696</span>
<span class="n">b</span>	<span class="o">-</span><span class="mf">3.542210</span>	<span class="mf">0.460190</span>	<span class="mf">0.339993</span>
<span class="n">b</span>	<span class="o">-</span><span class="mf">0.718968</span>	<span class="o">-</span><span class="mf">0.049578</span>	<span class="mf">0.127387</span>

<span class="n">df</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">is_unique</span>
<span class="n">Output</span><span class="p">:</span> <span class="bp">False</span>

<span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'b'</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span>
	<span class="mi">0</span>	<span class="mi">1</span>	<span class="mi">2</span>
<span class="n">b</span>	<span class="o">-</span><span class="mf">3.542210</span>	<span class="mf">0.460190</span>	<span class="mf">0.339993</span>
<span class="n">b</span>	<span class="o">-</span><span class="mf">0.718968</span>	<span class="o">-</span><span class="mf">0.049578</span>	<span class="mf">0.127387</span>
</pre></table></code></div></div><h2 id="summarizing-and-computing-descriptive-statistics"><span class="mr-2">Summarizing and Computing Descriptive Statistics</span><a href="#summarizing-and-computing-descriptive-statistics" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>pandas objects are equipped with a set of common mathematical and statistical meth‐ ods. Most of these fall into the category of reductions or summary statistics, methods that extract a single value (like the sum or mean) from a Series or a Series of values from the rows or columns of a DataFrame.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mf">1.4</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.5</span><span class="p">],</span>
                  <span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3</span><span class="p">]],</span>
                 <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'d'</span><span class="p">],</span>
                 <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'one'</span><span class="p">,</span> <span class="s">'two'</span><span class="p">])</span>
<span class="n">df</span>

<span class="n">Output</span><span class="p">:</span>
	<span class="n">one</span>	<span class="n">two</span>
<span class="n">a</span>	<span class="mf">1.40</span>	<span class="n">NaN</span>
<span class="n">b</span>	<span class="mf">7.10</span>	<span class="o">-</span><span class="mf">4.5</span>
<span class="n">c</span>	<span class="n">NaN</span>	<span class="n">NaN</span>
<span class="n">d</span>	<span class="mf">0.75</span>	<span class="o">-</span><span class="mf">1.3</span>
</pre></table></code></div></div><p>Calling DataFrame’s sum method returns a Series containing Column Sums</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">df</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">one</span>    <span class="mf">9.25</span>
    <span class="n">two</span>   <span class="o">-</span><span class="mf">5.80</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p>Passing <code class="language-plaintext highlighter-rouge">axis = 'columns'</code> or <code class="language-plaintext highlighter-rouge">axis = 1</code> sums across the columsn instead</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="n">df</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'columns'</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mf">1.40</span>
    <span class="n">b</span>    <span class="mf">2.60</span>
    <span class="n">c</span>    <span class="mf">0.00</span>
    <span class="n">d</span>   <span class="o">-</span><span class="mf">0.55</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>

<span class="n">df</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'columns'</span><span class="p">,</span><span class="n">skipna</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>     <span class="n">NaN</span>
    <span class="n">b</span>    <span class="mf">2.60</span>
    <span class="n">c</span>     <span class="n">NaN</span>
    <span class="n">d</span>   <span class="o">-</span><span class="mf">0.55</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">NA</code> values are excluded unless the entire slice (row or column in this case) is <code class="language-plaintext highlighter-rouge">NA</code>. This can be disabled with the skipna option</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">df</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s">'columns'</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>      <span class="n">NaN</span>
    <span class="n">b</span>    <span class="mf">1.300</span>
    <span class="n">c</span>      <span class="n">NaN</span>
    <span class="n">d</span>   <span class="o">-</span><span class="mf">0.275</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></table></code></div></div><p><img data-src="/assets/img/reduction.png" alt="img" data-proofer-ignore></p><p>Some methods like <code class="language-plaintext highlighter-rouge">idxmin</code> and <code class="language-plaintext highlighter-rouge">idxmax</code> return indirect statistics like the index value where the minimum or maximum values are attained:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">df</span><span class="p">.</span><span class="n">idxmax</span><span class="p">()</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">one</span>    <span class="n">b</span>
    <span class="n">two</span>    <span class="n">d</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></table></code></div></div><p>Other methods are accumulations</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">df</span><span class="p">.</span><span class="n">cumsum</span><span class="p">()</span>

<span class="n">Output</span><span class="p">:</span>
	<span class="n">one</span>	<span class="n">two</span>
<span class="n">a</span>	<span class="mf">1.40</span>	<span class="n">NaN</span>
<span class="n">b</span>	<span class="mf">8.50</span>	<span class="o">-</span><span class="mf">4.5</span>
<span class="n">c</span>	<span class="n">NaN</span>	<span class="n">NaN</span>
<span class="n">d</span>	<span class="mf">9.25</span>	<span class="o">-</span><span class="mf">5.8</span>
</pre></table></code></div></div><p>Another type of method is neither a reduction nor an accumulatoin. <code class="language-plaintext highlighter-rouge">describe</code>is one such example, producing multiple summary statistics in one shot.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="n">df</span><span class="p">.</span><span class="n">describe</span><span class="p">()</span>

<span class="n">Output</span><span class="p">:</span>
	<span class="n">one</span>	<span class="n">two</span>
<span class="n">count</span>	<span class="mf">3.000000</span>	<span class="mf">2.000000</span>
<span class="n">mean</span>	<span class="mf">3.083333</span>	<span class="o">-</span><span class="mf">2.900000</span>
<span class="n">std</span>	<span class="mf">3.493685</span>	<span class="mf">2.262742</span>
<span class="nb">min</span>	<span class="mf">0.750000</span>	<span class="o">-</span><span class="mf">4.500000</span>
<span class="mi">25</span><span class="o">%</span>	<span class="mf">1.075000</span>	<span class="o">-</span><span class="mf">3.700000</span>
<span class="mi">50</span><span class="o">%</span>	<span class="mf">1.400000</span>	<span class="o">-</span><span class="mf">2.900000</span>
<span class="mi">75</span><span class="o">%</span>	<span class="mf">4.250000</span>	<span class="o">-</span><span class="mf">2.100000</span>
<span class="nb">max</span>	<span class="mf">7.100000</span>	<span class="o">-</span><span class="mf">1.300000</span>
</pre></table></code></div></div><p>On non-numeric data, describe produces alternative summary statistics</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">obj</span><span class="p">.</span><span class="n">describe</span><span class="p">()</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">count</span>     <span class="mi">16</span>
    <span class="n">unique</span>     <span class="mi">3</span>
    <span class="n">top</span>        <span class="n">a</span>
    <span class="n">freq</span>       <span class="mi">8</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></table></code></div></div><p><img data-src="/assets/img/descriptive_stats.png" alt="img" data-proofer-ignore></p><h2 id="unique-values-value-counts-and-membership"><span class="mr-2">Unique Values, Value Counts, and Membership</span><a href="#unique-values-value-counts-and-membership" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="s">'c'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'d'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">])</span>
<span class="n">uniques</span> <span class="o">=</span> <span class="n">obj</span><span class="p">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">uniques</span>
<span class="n">Output</span><span class="p">:</span>    <span class="n">array</span><span class="p">([</span><span class="s">'c'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'d'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></table></code></div></div><p>The unique values are not necessarily returned in sorted order, but could be sorted after the fact if needed (uniques.sort()). Relatedly, value_counts computes a Series containing value frequencies</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">obj</span><span class="p">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mi">3</span>
    <span class="n">c</span>    <span class="mi">3</span>
    <span class="n">b</span>    <span class="mi">2</span>
    <span class="n">d</span>    <span class="mi">1</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></table></code></div></div><p>The Series is sorted by value in descending order as a convenience. But it can be sorted in ascending order as well by setting the attribute of sort value to False</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">pd</span><span class="p">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">obj</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="n">a</span>    <span class="mi">3</span>
    <span class="n">d</span>    <span class="mi">1</span>
    <span class="n">c</span>    <span class="mi">3</span>
    <span class="n">b</span>    <span class="mi">2</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">isin</code> performs a vectorized set memebership check and can be useful in filtering a dataset down to a subset of values in a Series or column in a Dataframe</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="n">obj</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">0</span>    <span class="n">c</span>
    <span class="mi">1</span>    <span class="n">a</span>
    <span class="mi">2</span>    <span class="n">d</span>
    <span class="mi">3</span>    <span class="n">a</span>
    <span class="mi">4</span>    <span class="n">a</span>
    <span class="mi">5</span>    <span class="n">b</span>
    <span class="mi">6</span>    <span class="n">b</span>
    <span class="mi">7</span>    <span class="n">c</span>
    <span class="mi">8</span>    <span class="n">c</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">mask</span> <span class="o">=</span> <span class="n">obj</span><span class="p">.</span><span class="n">isin</span><span class="p">([</span><span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">])</span>
<span class="n">mask</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">0</span>     <span class="bp">True</span>
    <span class="mi">1</span>    <span class="bp">False</span>
    <span class="mi">2</span>    <span class="bp">False</span>
    <span class="mi">3</span>    <span class="bp">False</span>
    <span class="mi">4</span>    <span class="bp">False</span>
    <span class="mi">5</span>     <span class="bp">True</span>
    <span class="mi">6</span>     <span class="bp">True</span>
    <span class="mi">7</span>     <span class="bp">True</span>
    <span class="mi">8</span>     <span class="bp">True</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1">#equivalent numpy expression
</span><span class="n">np</span><span class="p">.</span><span class="n">in1d</span><span class="p">(</span><span class="n">obj</span><span class="p">,[</span><span class="s">'b'</span><span class="p">,</span><span class="s">'c'</span><span class="p">])</span>
<span class="n">Output</span>
    <span class="n">array</span><span class="p">([</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span>  <span class="bp">True</span><span class="p">,</span>  <span class="bp">True</span><span class="p">,</span>  <span class="bp">True</span><span class="p">,</span>  <span class="bp">True</span><span class="p">])</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">obj</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">Output</span><span class="p">:</span>
    <span class="mi">0</span>    <span class="n">c</span>
    <span class="mi">5</span>    <span class="n">b</span>
    <span class="mi">6</span>    <span class="n">b</span>
    <span class="mi">7</span>    <span class="n">c</span>
    <span class="mi">8</span>    <span class="n">c</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></table></code></div></div><p>Related to <code class="language-plaintext highlighter-rouge">isin</code> is the <code class="language-plaintext highlighter-rouge">Index.get_indexer method</code>, which gives us an index array from an array of possibly non-distinct values into another array of distinct values</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">to_match</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="s">'c'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">])</span>
<span class="n">unique_vals</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">([</span><span class="s">'c'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'a'</span><span class="p">])</span>
<span class="n">pd</span><span class="p">.</span><span class="n">Index</span><span class="p">(</span><span class="n">unique_vals</span><span class="p">).</span><span class="n">get_indexer</span><span class="p">(</span><span class="n">to_match</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)</span>
</pre></table></code></div></div><p><img data-src="/assets/img/unique_val_count.png" alt="img" data-proofer-ignore></p><p>In some cases, we may want to compute a histogram on multiple related columns in a DataFrame.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'Qu1'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                    <span class="s">'Qu2'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                    <span class="s">'Qu3'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]})</span>
<span class="n">data</span>
<span class="n">Output</span><span class="p">:</span> 
	<span class="n">Qu1</span>	<span class="n">Qu2</span>	<span class="n">Qu3</span>
<span class="mi">0</span>	<span class="mi">1</span>	<span class="mi">2</span>	<span class="mi">1</span>
<span class="mi">1</span>	<span class="mi">3</span>	<span class="mi">3</span>	<span class="mi">5</span>
<span class="mi">2</span>	<span class="mi">4</span>	<span class="mi">1</span>	<span class="mi">2</span>
<span class="mi">3</span>	<span class="mi">3</span>	<span class="mi">2</span>	<span class="mi">4</span>
<span class="mi">4</span>	<span class="mi">4</span>	<span class="mi">3</span>	<span class="mi">4</span>

<span class="n">data</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="n">value_counts</span><span class="p">)</span>
<span class="n">Output</span><span class="p">:</span>
	<span class="n">Qu1</span>	<span class="n">Qu2</span>	<span class="n">Qu3</span>
<span class="mi">1</span>	<span class="mf">1.0</span>	<span class="mf">1.0</span>	<span class="mf">1.0</span>
<span class="mi">2</span>	<span class="n">NaN</span>	<span class="mf">2.0</span>	<span class="mf">1.0</span>
<span class="mi">3</span>	<span class="mf">2.0</span>	<span class="mf">2.0</span>	<span class="n">NaN</span>
<span class="mi">4</span>	<span class="mf">2.0</span>	<span class="n">NaN</span>	<span class="mf">2.0</span>
<span class="mi">5</span>	<span class="n">NaN</span>	<span class="n">NaN</span>	<span class="mf">1.0</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="n">value_counts</span><span class="p">).</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">result</span>

<span class="n">Output</span><span class="p">:</span>
	<span class="n">Qu1</span>	<span class="n">Qu2</span>	<span class="n">Qu3</span>
<span class="mi">1</span>	<span class="mf">1.0</span>	<span class="mf">1.0</span>	<span class="mf">1.0</span>
<span class="mi">2</span>	<span class="mf">0.0</span>	<span class="mf">2.0</span>	<span class="mf">1.0</span>
<span class="mi">3</span>	<span class="mf">2.0</span>	<span class="mf">2.0</span>	<span class="mf">0.0</span>
<span class="mi">4</span>	<span class="mf">2.0</span>	<span class="mf">0.0</span>	<span class="mf">2.0</span>
<span class="mi">5</span>	<span class="mf">0.0</span>	<span class="mf">0.0</span>	<span class="mf">1.0</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/pandas/'>pandas</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/pandas/" class="post-tag no-text-decoration" >pandas</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Introduction to Pandas - Babin Joshi&amp;url=https://babin411.github.io/posts/pandas1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Introduction to Pandas - Babin Joshi&amp;u=https://babin411.github.io/posts/pandas1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://babin411.github.io/posts/pandas1/&amp;text=Introduction to Pandas - Babin Joshi" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/wildcards/">Wild Cards Tutorial</a><li><a href="/posts/Linux-Basic-Commands/">Basic Linux Commands</a><li><a href="/posts/3sql4/">Window Functions</a><li><a href="/posts/pandas1/">Introduction to Pandas</a><li><a href="/posts/mongodb-dm4/">4. Patterns 2</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/sql/">sql</a> <a class="post-tag" href="/tags/t-sql/">t-sql</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mongodb/">mongodb</a> <a class="post-tag" href="/tags/curl/">curl</a> <a class="post-tag" href="/tags/wget/">wget</a> <a class="post-tag" href="/tags/avg/">avg</a> <a class="post-tag" href="/tags/count/">count</a> <a class="post-tag" href="/tags/max/">max</a> <a class="post-tag" href="/tags/min/">min</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/netstat/"><div class="card-body"> <em class="timeago small" data-ts="1667412900" > 2022-11-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Netstat command to troubleshoot network issues</h3><div class="text-muted small"><p> The netstat is used for Network Monitoring and Troubleshooting. It stands for the Network Statistics. The netstat is a command-line network utility that displays: network connections for tcp, ud...</p></div></div></a></div><div class="card"> <a href="/posts/linux-redirects/"><div class="card-body"> <em class="timeago small" data-ts="1667412900" > 2022-11-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Linux Redirects</h3><div class="text-muted small"><p> There are 3 redirects: Basically, when we run a command in terminal, belwo three files are created. Company File Descriptor Standard Input (stdin) ...</p></div></div></a></div><div class="card"> <a href="/posts/cron/"><div class="card-body"> <em class="timeago small" data-ts="1667412900" > 2022-11-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cron Job Linux</h3><div class="text-muted small"><p> The software utility cron also known as cron job is a time-based job scheduler in Unix-like computer operating systems. Users who set up and maintain software environments use cron to schedule job...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/mongodb-dm4/" class="btn btn-outline-primary" prompt="Older"><p>4. Patterns 2</p></a> <a href="/posts/python1/" class="btn btn-outline-primary" prompt="Newer"><p>Built-in Data Structures, Functions and Files</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/Babinjoshi411">Babin Joshi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/sql/">sql</a> <a class="post-tag" href="/tags/t-sql/">t-sql</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mongodb/">mongodb</a> <a class="post-tag" href="/tags/curl/">curl</a> <a class="post-tag" href="/tags/wget/">wget</a> <a class="post-tag" href="/tags/avg/">avg</a> <a class="post-tag" href="/tags/count/">count</a> <a class="post-tag" href="/tags/max/">max</a> <a class="post-tag" href="/tags/min/">min</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
