<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Basic Date From Parts" /><meta name="author" content="Babin" /><meta property="og:locale" content="en" /><meta name="description" content="Dates from parts DATEFROMPARTS(year,month,day) TIMEFROMPARTS(hour, minute, second, fraction, precision) DATETIMEFROMPARTS(year, month, day, hour, minute, seconds,ms) DATETIME2FROMPARTS(year, month, day, hour, minute, second, fraction, precision) SMALLDATETIMEFROMPARTS(year, month, day, hour, minute) DATETIMEOFFSETFROMPARTS(year, month, day, hour, minute, second, fraction, hour_offset, minute_offset, precision)" /><meta property="og:description" content="Dates from parts DATEFROMPARTS(year,month,day) TIMEFROMPARTS(hour, minute, second, fraction, precision) DATETIMEFROMPARTS(year, month, day, hour, minute, seconds,ms) DATETIME2FROMPARTS(year, month, day, hour, minute, second, fraction, precision) SMALLDATETIMEFROMPARTS(year, month, day, hour, minute) DATETIMEOFFSETFROMPARTS(year, month, day, hour, minute, second, fraction, hour_offset, minute_offset, precision)" /><link rel="canonical" href="https://babin411.github.io/posts/4sql2/" /><meta property="og:url" content="https://babin411.github.io/posts/4sql2/" /><meta property="og:site_name" content="Babin Joshi" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-16T00:00:00+05:45" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Basic Date From Parts" /><meta name="twitter:site" content="@BabinJoshi411" /><meta name="twitter:creator" content="@Babin" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Babin"},"dateModified":"2022-06-13T18:11:36+05:45","datePublished":"2022-05-16T00:00:00+05:45","description":"Dates from parts DATEFROMPARTS(year,month,day) TIMEFROMPARTS(hour, minute, second, fraction, precision) DATETIMEFROMPARTS(year, month, day, hour, minute, seconds,ms) DATETIME2FROMPARTS(year, month, day, hour, minute, second, fraction, precision) SMALLDATETIMEFROMPARTS(year, month, day, hour, minute) DATETIMEOFFSETFROMPARTS(year, month, day, hour, minute, second, fraction, hour_offset, minute_offset, precision)","headline":"Basic Date From Parts","mainEntityOfPage":{"@type":"WebPage","@id":"https://babin411.github.io/posts/4sql2/"},"url":"https://babin411.github.io/posts/4sql2/"}</script><title>Basic Date From Parts | Babin Joshi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Babin Joshi"><meta name="application-name" content="Babin Joshi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/dp.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Babin Joshi</a></div><div class="site-subtitle font-italic">Life is a cruel prank played on the living - Charles Boyle</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/babin411" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/BabinJoshi411" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['j.babin411','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Basic Date From Parts</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Basic Date From Parts</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Babinjoshi411">Babin Joshi</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1652638500" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-16 </em> </span> <span> Updated <em class="timeago" data-ts="1655123196" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-13 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="365 words"> <em>2 min</em> read</span></div></div></div><div class="post-content"><ul><li><h2 id="dates-from-parts"><span class="mr-2">Dates from parts</span><a href="#dates-from-parts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><code class="language-plaintext highlighter-rouge">DATEFROMPARTS(year,month,day)</code><li><code class="language-plaintext highlighter-rouge">TIMEFROMPARTS(hour, minute, second, fraction, precision)</code><li><code class="language-plaintext highlighter-rouge">DATETIMEFROMPARTS(year, month, day, hour, minute, seconds,ms)</code><li><code class="language-plaintext highlighter-rouge">DATETIME2FROMPARTS(year, month, day, hour, minute, second, fraction, precision)</code><li><code class="language-plaintext highlighter-rouge">SMALLDATETIMEFROMPARTS(year, month, day, hour, minute)</code><li><code class="language-plaintext highlighter-rouge">DATETIMEOFFSETFROMPARTS(year, month, day, hour, minute, second, fraction, hour_offset, minute_offset, precision)</code></ul><li><h2 id="dates-and-times-together"><span class="mr-2">Dates and times together</span><a href="#dates-and-times-together" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>      <span class="k">SELECT</span>
          <span class="n">DATETIMEFROMPARTS</span><span class="p">(</span><span class="mi">1918</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">05</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">995</span><span class="p">)</span> <span class="k">AS</span> <span class="n">DT</span><span class="p">,</span>
          <span class="n">DATETIME2FROMPARTS</span><span class="p">(</span><span class="mi">1918</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">05</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="k">AS</span> <span class="n">DT20</span><span class="p">,</span>
          <span class="n">DATETIME2FROMPARTS</span><span class="p">(</span><span class="mi">1918</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">05</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">995</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="k">AS</span> <span class="n">DT23</span><span class="p">,</span>
          <span class="n">DATETIME2FROMPARTS</span><span class="p">(</span><span class="mi">1918</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">05</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">9951234</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="k">AS</span> <span class="n">DT27</span><span class="p">;</span>
</pre></table></code></div></div><li><h2 id="working-with-offets"><span class="mr-2">Working with Offets</span><a href="#working-with-offets" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>      <span class="k">SELECT</span>
          <span class="n">DATETIMEOFFSETFROMPARTS</span><span class="p">(</span><span class="mi">2009</span><span class="p">,</span><span class="mi">08</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">00</span><span class="p">,</span><span class="mi">00</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="k">AS</span> <span class="n">IST</span><span class="p">,</span>
          <span class="n">DATETIMEOFFSETFROMPARTS</span><span class="p">(</span><span class="mi">2009</span><span class="p">,</span><span class="mi">08</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">00</span><span class="p">,</span><span class="mi">00</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="k">AT</span> <span class="nb">TIME</span> <span class="k">ZONE</span> <span class="s1">'UTC'</span> <span class="k">AS</span> <span class="n">UTC</span><span class="p">;</span>
</pre></table></code></div></div></ul><hr /><h1 id="translating-date-strings">Translating date strings</h1><ul><li><h2 id="casting-strings"><span class="mr-2">Casting strings</span><a href="#casting-strings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>      <span class="k">SELECT</span>
          <span class="k">CAST</span><span class="p">(</span><span class="s1">'09/14/99'</span> <span class="k">AS</span> <span class="nb">DATE</span><span class="p">)</span> <span class="k">AS</span> <span class="n">USDate</span><span class="p">;</span>
</pre></table></code></div></div><li><h2 id="converting-strings"><span class="mr-2">Converting Strings</span><a href="#converting-strings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>      <span class="k">SELECT</span>
          <span class="k">CONVERT</span><span class="p">(</span><span class="n">DATETIME2</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="s1">'April 4, 2019 11:52:29.998 PM'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">April14</span><span class="p">;</span>
</pre></table></code></div></div><li><h2 id="parsing-strings"><span class="mr-2">Parsing Strings</span><a href="#parsing-strings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>      <span class="k">SELECT</span>
          <span class="n">PARSE</span><span class="p">(</span><span class="s1">'25 Dezember 2014'</span> <span class="k">AS</span> <span class="nb">DATE</span> <span class="k">USING</span> <span class="s1">'de-de'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">Wihnachten</span><span class="p">;</span>
</pre></table></code></div></div><li><h2 id="the-cost-of-parsing"><span class="mr-2">The cost of parsing</span><a href="#the-cost-of-parsing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="table-wrapper"><table><thead><tr><th style="text-align: left">Function<th style="text-align: left">Conversions Per Second<tbody><tr><td style="text-align: left">CONVERT()<td style="text-align: left">251,997<tr><td style="text-align: left">CAST()<td style="text-align: left">240,347<tr><td style="text-align: left">PARSE()<td style="text-align: left">12,620</table></div><li><h2 id="setting-languages"><span class="mr-2">Setting Languages</span><a href="#setting-languages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>      <span class="k">SET</span> <span class="k">LANGUAGE</span> <span class="s1">'FRENCH'</span>
      <span class="k">DECLARE</span>
          <span class="o">@</span><span class="n">FrenchDate</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'18 avril 2019'</span><span class="p">,</span>
          <span class="o">@</span><span class="n">FrenchNumberDate</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="o">=</span> <span class="n">N</span><span class="s1">'18/4/2019'</span><span class="p">;</span>

      <span class="k">SELECT</span>
          <span class="k">CAST</span><span class="p">(</span><span class="o">@</span><span class="n">FrenchDate</span> <span class="k">AS</span> <span class="nb">DATETIME</span><span class="p">),</span>
          <span class="k">CAST</span><span class="p">(</span><span class="o">@</span><span class="n">FrenchNumberDate</span> <span class="k">AS</span> <span class="nb">DATETIME</span><span class="p">);</span>
</pre></table></code></div></div></ul><hr /><h1 id="working-with-offsets">Working With Offsets</h1><ul><li><h2 id="anatomy-of-a-datetimeoffset-components"><span class="mr-2">Anatomy of a DATETIMEOFFSET Components</span><a href="#anatomy-of-a-datetimeoffset-components" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="table-wrapper"><table><thead><tr><th style="text-align: left">Date Part<th style="text-align: left">Example<tbody><tr><td style="text-align: left">Date<td style="text-align: left">2019-04-10<tr><td style="text-align: left">Time<td style="text-align: left">12:59:02.3908505<tr><td style="text-align: left">UTC Offset<td style="text-align: left">-04:00</table></div><li><h2 id="changing-offsets"><span class="mr-2">Changing Offsets</span><a href="#changing-offsets" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>      <span class="k">DECLARE</span> <span class="o">@</span><span class="n">SomeDate</span> <span class="n">DATETIMEOFFSET</span> <span class="o">=</span> <span class="s1">'2019-04-10 12:59:02.3908505 -04:00'</span><span class="p">;</span>

      <span class="k">SELECT</span>
          <span class="n">SWITCHOFFSET</span><span class="p">(</span><span class="o">@</span><span class="n">SomeDate</span><span class="p">,</span> <span class="s1">'-07:00'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">LATime</span><span class="p">;</span>
</pre></table></code></div></div><li><h2 id="converting-to-datetimeoffset"><span class="mr-2">Converting to DATETIMEOFFSET</span><a href="#converting-to-datetimeoffset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>      <span class="k">DECLARE</span> <span class="o">@</span><span class="n">SomeDate</span> <span class="n">DATETIME2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="s1">'2019-04-10 12:59:02.390'</span><span class="p">;</span>

      <span class="k">SELECT</span>
          <span class="n">TODATETIMEOFFSET</span><span class="p">(</span><span class="o">@</span><span class="n">SomeDate</span><span class="p">,</span> <span class="s1">'-04:00'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">EDT</span><span class="p">;</span>
</pre></table></code></div></div><li><h2 id="time-zone-swaps-with-todatetimeoffset"><span class="mr-2">Time Zone Swaps with TODATETIMEOFFSET</span><a href="#time-zone-swaps-with-todatetimeoffset" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>      <span class="k">DECLARE</span> <span class="o">@</span><span class="n">SomeDate</span> <span class="n">DATETIME2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="s1">'2016-09-04 02:28:29.681'</span><span class="p">;</span>

      <span class="k">SELECT</span>
          <span class="n">TODATETIMEOFFSET</span><span class="p">(</span>
              <span class="n">DATEADD</span><span class="p">(</span><span class="n">HOUR</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">@</span><span class="n">SomeDate</span><span class="p">),</span> 
              <span class="s1">'_02:00'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">BonnTime</span><span class="p">;</span>
</pre></table></code></div></div><li><h2 id="discovering-time-zones"><span class="mr-2">Discovering time zones</span><a href="#discovering-time-zones" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>      <span class="k">SELECT</span>
          <span class="n">tzi</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> 
          <span class="n">tzi</span><span class="p">.</span><span class="n">current_utc_offset</span><span class="p">,</span>
          <span class="n">tzi</span><span class="p">.</span><span class="n">is_currently_dst</span>
      <span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">time_zone_info</span> <span class="n">tzi</span>
      <span class="k">WHERE</span> 
          <span class="n">tzi</span><span class="p">.</span><span class="n">name</span> <span class="k">LIKE</span> <span class="s1">'%Time Zone%'</span><span class="p">;</span>
</pre></table></code></div></div></ul><hr /><h1 id="handling-invalid-dates">Handling Invalid Dates</h1><ul><li><h2 id="error-safe-date-conversion-functions"><span class="mr-2">Error-safe date conversion functions</span><a href="#error-safe-date-conversion-functions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>“Unsafe” Functions<ul><li>CAST()<li>CONVERT()<li>PARSE()</ul><li>“Safe” Functions<ul><li>TRY_CAST()<li>TRY_CONVERT()<li>TRY_PARSE()</ul></ul><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>      <span class="k">SELECT</span>
          <span class="n">PARSE</span><span class="p">(</span><span class="s1">'01/13/2019'</span> <span class="k">AS</span> <span class="nb">DATE</span> <span class="k">USING</span> <span class="s1">'en-us'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">January13US</span><span class="p">,</span>
          <span class="n">PARSE</span><span class="p">(</span><span class="s1">'01/13/2019'</span> <span class="k">AS</span> <span class="nb">DATE</span> <span class="k">USING</span> <span class="s1">'fr-fr'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">Smarch1FR</span><span class="p">;</span> 
</pre></table></code></div></div><blockquote class="prompt-danger"><div><p>The above sql statements returns as error while converting string value ‘01/13/2019’ into data type date using culture ‘fr-fr’.</p></div></blockquote><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>      <span class="k">SELECT</span>
          <span class="n">TRY_PARSE</span><span class="p">(</span><span class="s1">'01/13/2019'</span> <span class="k">AS</span> <span class="nb">DATE</span> <span class="k">USING</span> <span class="s1">'en-us'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">January13US</span><span class="p">,</span>
          <span class="n">TRY_PARSE</span><span class="p">(</span><span class="s1">'01/13/2019'</span> <span class="k">AS</span> <span class="nb">DATE</span> <span class="k">USING</span> <span class="s1">'fr-fr'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">Smarch1FR</span><span class="p">;</span>
</pre></table></code></div></div><blockquote class="prompt-warning"><div><p>The above sql statements will not return an error while converting string value ‘01/13/2019’ into data type date using culture ‘fr-fr’ but instead return NULL as the value for Smarch1FR</p></div></blockquote></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/sql/'>SQL</a>, <a href='/categories/4-time-series-analysis-with-sql-server/'>4. Time Series Analysis With SQL Server</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/sql/" class="post-tag no-text-decoration" >sql</a> <a href="/tags/t-sql/" class="post-tag no-text-decoration" >t-sql</a> <a href="/tags/datefromparts/" class="post-tag no-text-decoration" >datefromparts</a> <a href="/tags/timefromparts/" class="post-tag no-text-decoration" >timefromparts</a> <a href="/tags/datetimefromparts/" class="post-tag no-text-decoration" >datetimefromparts</a> <a href="/tags/datetime2fromparts/" class="post-tag no-text-decoration" >datetime2fromparts</a> <a href="/tags/smalldatetimefromparts/" class="post-tag no-text-decoration" >smalldatetimefromparts</a> <a href="/tags/datetimeoffsetfromparts/" class="post-tag no-text-decoration" >datetimeoffsetfromparts</a> <a href="/tags/set-language/" class="post-tag no-text-decoration" >set language</a> <a href="/tags/switchoffset/" class="post-tag no-text-decoration" >switchoffset</a> <a href="/tags/todatetimeoffset/" class="post-tag no-text-decoration" >todatetimeoffset</a> <a href="/tags/try-cast/" class="post-tag no-text-decoration" >try_cast</a> <a href="/tags/try-convert/" class="post-tag no-text-decoration" >try_convert</a> <a href="/tags/try-parse/" class="post-tag no-text-decoration" >try_parse</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Basic Date From Parts - Babin Joshi&amp;url=https://babin411.github.io/posts/4sql2/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Basic Date From Parts - Babin Joshi&amp;u=https://babin411.github.io/posts/4sql2/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://babin411.github.io/posts/4sql2/&amp;text=Basic Date From Parts - Babin Joshi" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/wildcards/">Wild Cards Tutorial</a><li><a href="/posts/Linux-Basic-Commands/">Basic Linux Commands</a><li><a href="/posts/3sql4/">Window Functions</a><li><a href="/posts/pandas1/">Introduction to Pandas</a><li><a href="/posts/mongodb-dm4/">4. Patterns 2</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/sql/">sql</a> <a class="post-tag" href="/tags/t-sql/">t-sql</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mongodb/">mongodb</a> <a class="post-tag" href="/tags/curl/">curl</a> <a class="post-tag" href="/tags/wget/">wget</a> <a class="post-tag" href="/tags/avg/">avg</a> <a class="post-tag" href="/tags/count/">count</a> <a class="post-tag" href="/tags/max/">max</a> <a class="post-tag" href="/tags/min/">min</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/5sql2/"><div class="card-body"> <em class="timeago small" data-ts="1652724900" > 2022-05-17 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Functions that return system date and time</h3><div class="text-muted small"><p> Common mistakes when working with dates and time Inconsistent date time formats or patterns Arithmetic Operations Issues with time zones Time Zones in...</p></div></div></a></div><div class="card"> <a href="/posts/4sql1/"><div class="card-body"> <em class="timeago small" data-ts="1652638500" > 2022-05-16 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Building Dates</h3><div class="text-muted small"><p> Building Dates Building a Date SELECT GETDATE() AS DateTime_LTz, GETUTCDATE() AS DateTime_UTC; SELECT SYSDATETIME() AS DateTime2_LTz,...</p></div></div></a></div><div class="card"> <a href="/posts/4sql3/"><div class="card-body"> <em class="timeago small" data-ts="1652638500" > 2022-05-16 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Basic Aggregate Functions</h3><div class="text-muted small"><p> Key Aggregation Functions Counts COUNT() COUNT_BIG() COUNT(DISTINCT) Other Aggregates SUM() ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/4sql1/" class="btn btn-outline-primary" prompt="Older"><p>Building Dates</p></a> <a href="/posts/4sql3/" class="btn btn-outline-primary" prompt="Newer"><p>Basic Aggregate Functions</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/Babinjoshi411">Babin Joshi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/sql/">sql</a> <a class="post-tag" href="/tags/t-sql/">t-sql</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mongodb/">mongodb</a> <a class="post-tag" href="/tags/curl/">curl</a> <a class="post-tag" href="/tags/wget/">wget</a> <a class="post-tag" href="/tags/avg/">avg</a> <a class="post-tag" href="/tags/count/">count</a> <a class="post-tag" href="/tags/max/">max</a> <a class="post-tag" href="/tags/min/">min</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
