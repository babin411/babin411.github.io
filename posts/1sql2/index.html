<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Aggregating Data" /><meta name="author" content="Babin" /><meta property="og:locale" content="en" /><meta name="description" content="SUM It is used to calculate the total amount of a column. Example: 1 2 3 SELECT SUM(affected_customers) AS total_affected FROM grid; Returns the total of all the affected_customers" /><meta property="og:description" content="SUM It is used to calculate the total amount of a column. Example: 1 2 3 SELECT SUM(affected_customers) AS total_affected FROM grid; Returns the total of all the affected_customers" /><link rel="canonical" href="https://babin411.github.io/posts/1sql2/" /><meta property="og:url" content="https://babin411.github.io/posts/1sql2/" /><meta property="og:site_name" content="Babin Joshi" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-13T00:00:00+05:45" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Aggregating Data" /><meta name="twitter:site" content="@BabinJoshi411" /><meta name="twitter:creator" content="@Babin" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Babin"},"dateModified":"2022-06-13T20:15:59+05:45","datePublished":"2022-05-13T00:00:00+05:45","description":"SUM It is used to calculate the total amount of a column. Example: 1 2 3 SELECT SUM(affected_customers) AS total_affected FROM grid; Returns the total of all the affected_customers","headline":"Aggregating Data","mainEntityOfPage":{"@type":"WebPage","@id":"https://babin411.github.io/posts/1sql2/"},"url":"https://babin411.github.io/posts/1sql2/"}</script><title>Aggregating Data | Babin Joshi</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Babin Joshi"><meta name="application-name" content="Babin Joshi"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/dp.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Babin Joshi</a></div><div class="site-subtitle font-italic">Life is a cruel prank played on the living - Charles Boyle</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/babin411" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/BabinJoshi411" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['j.babin411','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Aggregating Data</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Aggregating Data</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Babinjoshi411">Babin Joshi</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1652379300" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-13 </em> </span> <span> Updated <em class="timeago" data-ts="1655130659" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-13 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="699 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><ul><li><h2 id="sum"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">SUM</code></span><a href="#sum" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote class="prompt-info"><div><p>It is used to calculate the total amount of a column.</p></div></blockquote><ul><li><h3 id="example"><span class="mr-2">Example:</span><a href="#example" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span> 
      <span class="k">SUM</span><span class="p">(</span><span class="n">affected_customers</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_affected</span>
  <span class="k">FROM</span> <span class="n">grid</span><span class="p">;</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>Returns the total of all the <code class="language-plaintext highlighter-rouge">affected_customers</code></p></div></blockquote><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span> 
      <span class="k">SUM</span><span class="p">(</span><span class="n">affected_customers</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_affected</span><span class="p">,</span>
      <span class="k">SUM</span><span class="p">(</span><span class="n">demand_loss_mw</span><span class="p">)</span> <span class="k">AS</span> <span class="n">total_loss</span>
  <span class="k">FROM</span> <span class="n">grid</span><span class="p">;</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>Returns the total of all the <code class="language-plaintext highlighter-rouge">affected_customers</code> amd <code class="language-plaintext highlighter-rouge">demand_loss_mw</code> columns.</p></div></blockquote></ul></ul><li><h2 id="count"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">COUNT</code></span><a href="#count" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote class="prompt-info"><div><p>It returns the total count of the records</p></div></blockquote><ul><li><h3 id="example-1"><span class="mr-2">Example:</span><a href="#example-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span>
      <span class="k">COUNT</span><span class="p">(</span><span class="n">affected_customers</span><span class="p">)</span> <span class="k">AS</span> <span class="n">count_affected</span>
  <span class="k">FROM</span> <span class="n">grid</span><span class="p">;</span>
</pre></table></code></div></div></ul></ul><li><h2 id="count-distinct"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">COUNT DISTINCT</code></span><a href="#count-distinct" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote class="prompt-info"><div><p>It returns the total count of the distinct records</p></div></blockquote><ul><li><h3 id="example-2"><span class="mr-2">Example:</span><a href="#example-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span>
      <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">affected_customers</span><span class="p">)</span> <span class="k">AS</span> <span class="n">unique_count_affected</span>
  <span class="k">FROM</span> <span class="n">grid</span><span class="p">;</span>
</pre></table></code></div></div></ul></ul><li><h2 id="min"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">MIN</code></span><a href="#min" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote class="prompt-info"><div><p>It returns the minimum value of a column</p></div></blockquote><ul><li><h3 id="example-3"><span class="mr-2">Example:</span><a href="#example-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span>
      <span class="k">MIN</span><span class="p">(</span><span class="n">affected_customers</span><span class="p">)</span> <span class="k">AS</span> <span class="n">min_affected_customers</span>
  <span class="k">FROM</span> <span class="n">grid</span>
  <span class="k">WHERE</span> <span class="n">affected_customers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>It returns the minimum value of the <code class="language-plaintext highlighter-rouge">affected_customer</code> column from all the records where <code class="language-plaintext highlighter-rouge">affected_customer</code> &gt; 0.</p></div></blockquote></ul></ul><li><h2 id="max"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">MAX</code></span><a href="#max" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote class="prompt-info"><div><p>It returns the maximum value of a column</p></div></blockquote><ul><li><h3 id="example-4"><span class="mr-2">Example:</span><a href="#example-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span>
      <span class="k">MAX</span><span class="p">(</span><span class="n">affected_customers</span><span class="p">)</span> <span class="k">AS</span> <span class="n">max_affected_customers</span>
  <span class="k">FROM</span> <span class="n">grid</span>
  <span class="k">WHERE</span> <span class="n">affected_customers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>It returns the maximum value of the <code class="language-plaintext highlighter-rouge">affected_customer</code> column from all the records where <code class="language-plaintext highlighter-rouge">affected_customer</code> &gt; 0.</p></div></blockquote></ul></ul><li><h2 id="avg"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">AVG</code></span><a href="#avg" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote class="prompt-info"><div><p>It returns the average value of a column</p></div></blockquote><ul><li><h3 id="example-5"><span class="mr-2">Example:</span><a href="#example-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span>
      <span class="k">AVG</span><span class="p">(</span><span class="n">affected_customers</span><span class="p">)</span> <span class="k">AS</span> <span class="n">avg_affected_customers</span>
  <span class="k">FROM</span> <span class="n">grid</span><span class="p">;</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>It returns the average value of the <code class="language-plaintext highlighter-rouge">affected_customer</code> column.</p></div></blockquote></ul></ul><li><h2 id="len"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">LEN</code></span><a href="#len" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote class="prompt-info"><div><p>It returns the length of a string</p></div></blockquote><ul><li><h3 id="example-6"><span class="mr-2">Example:</span><a href="#example-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span>
      <span class="n">description</span><span class="p">,</span>
      <span class="n">LEN</span><span class="p">(</span><span class="n">description</span><span class="p">)</span> <span class="k">AS</span> <span class="n">description_length</span>
  <span class="k">FROM</span> <span class="n">grid</span><span class="p">;</span>
</pre></table></code></div></div></ul></ul><li><h2 id="left"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">LEFT</code></span><a href="#left" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote class="prompt-info"><div><p>It returns the specified no of characters from the string from the left side.</p></div></blockquote><ul><li><h3 id="example-7"><span class="mr-2">Example:</span><a href="#example-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span>
      <span class="n">description</span><span class="p">,</span>
      <span class="k">LEFT</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="k">AS</span> <span class="n">first_20_left</span>
  <span class="k">FROM</span> <span class="n">grid</span><span class="p">;</span>
</pre></table></code></div></div></ul></ul><li><h2 id="right"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">RIGHT</code></span><a href="#right" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote class="prompt-info"><div><p>It returns the specified no of characters from the string from the right side.</p></div></blockquote><ul><li><h3 id="example-8"><span class="mr-2">Example:</span><a href="#example-8" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span>
      <span class="n">description</span><span class="p">,</span>
      <span class="k">RIGHT</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span> <span class="k">AS</span> <span class="n">last_20_</span>
  <span class="k">FROM</span> <span class="n">grid</span><span class="p">;</span>
</pre></table></code></div></div></ul></ul><li><h2 id="charindex"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">CHARINDEX</code></span><a href="#charindex" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote class="prompt-info"><div><p>The CHARINDEX() function searches for a substring from the left-side in a string, and returns the position. If the substring is not found, this function returns 0.</p></div></blockquote><ul><li><h3 id="example-9"><span class="mr-2">Example:</span><a href="#example-9" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span>
      <span class="n">CHARINDEX</span><span class="p">(</span><span class="s1">'-'</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span> <span class="k">AS</span> <span class="n">char_location</span><span class="p">,</span>
      <span class="n">url</span>
  <span class="k">FROM</span> <span class="n">courses</span><span class="p">;</span>
</pre></table></code></div></div></ul></ul><li><h2 id="substring"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">SUBSTRING</code></span><a href="#substring" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote class="prompt-info"><div><p>It returns the part of the string from the specified starting location to the specified end location.</p></div></blockquote><blockquote class="prompt-tip"><div><p>Syntax: REPLACE(string, start, end)</p></div></blockquote><ul><li><h3 id="example-10"><span class="mr-2">Example:</span><a href="#example-10" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span>
      <span class="k">SUBSTRING</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="k">AS</span> <span class="n">target_section</span><span class="p">,</span>
      <span class="n">url</span>
  <span class="k">FROM</span> <span class="n">courses</span><span class="p">;</span>
</pre></table></code></div></div></ul></ul><li><h2 id="replace"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">REPLACE</code></span><a href="#replace" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote class="prompt-info"><div><p>IT replaces all occurrences of a substring within a string, with a new substring.</p></div></blockquote><blockquote class="prompt-tip"><div><p>Syntax: REPLACE(string, old_string, new_string)</p></div></blockquote><ul><li><h3 id="example-11"><span class="mr-2">Example:</span><a href="#example-11" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span>
      <span class="n">TOP</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">REPLACE</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">,</span><span class="s1">'-'</span><span class="p">)</span> <span class="k">AS</span> <span class="n">replace_with_hyphen</span>
  <span class="k">FROM</span> <span class="n">grid</span><span class="p">;</span>
</pre></table></code></div></div></ul></ul><li><h2 id="group-by"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">GROUP BY</code></span><a href="#group-by" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote class="prompt-info"><div><p>The GROUP BY statement groups rows that have the same values into summary rows, like “find the number of customers in each country”. The GROUP BY statement is often used with aggregate functions (COUNT(), MAX(), MIN(), SUM(), AVG()) to group the result-set by one or more columns.</p></div></blockquote><ul><li><h3 id="example-12"><span class="mr-2">Example:</span><a href="#example-12" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span>
      <span class="k">SUM</span><span class="p">(</span><span class="n">demand_loss_mw</span><span class="p">)</span> <span class="k">AS</span> <span class="n">lost_demand</span><span class="p">,</span>
      <span class="n">description</span>
  <span class="k">FROM</span> <span class="n">grid</span>
  <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">description</span><span class="p">;</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>The above SQL statement groups the records by description and for each group calculates the sum of <code class="language-plaintext highlighter-rouge">demand_loss_mw</code>.</p></div></blockquote><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span>
      <span class="k">SUM</span><span class="p">(</span><span class="n">demand_loss_mw</span><span class="p">)</span> <span class="k">AS</span> <span class="n">lost_demand</span><span class="p">,</span>
      <span class="n">description</span>
  <span class="k">FROM</span> <span class="n">grid</span>
  <span class="k">WHERE</span> 
      <span class="n">description</span> <span class="k">LIKE</span> <span class="s1">'%storm'</span>
      <span class="k">AND</span> <span class="n">demand_loss_mw</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span>
  <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">description</span><span class="p">;</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>The above SQL statement groups the records by description and filters the records with the conditions specified in WHERE clause and then aggregates the <code class="language-plaintext highlighter-rouge">demand_loss_mw</code> field using the SUM function from the result queires.</p></div></blockquote></ul></ul><li><h2 id="having"><span class="mr-2"><code class="language-plaintext highlighter-rouge"><span class="mr-2">HAVING</code></span><a href="#having" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote class="prompt-info"><div><p>The <code class="language-plaintext highlighter-rouge">HAVING</code> clause was added to SQL because the WHERE keyword cannot be used with aggregate functions. It can be used when filtering with groups. We normally use <code class="language-plaintext highlighter-rouge">WHERE</code> to filter data but what if we want to sum values based on groups and then filter on those groups? In such cases, we use <code class="language-plaintext highlighter-rouge">HAVING</code>.</p></div></blockquote><ul><li><h3 id="example-13"><span class="mr-2">Example:</span><a href="#example-13" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>  <span class="k">SELECT</span> 
      <span class="k">SUM</span><span class="p">(</span><span class="n">demand_loss_mw</span><span class="p">)</span> <span class="k">AS</span> <span class="n">lost_demand</span><span class="p">,</span>
      <span class="n">description</span>
  <span class="k">FROM</span> <span class="n">grid</span>
  <span class="k">WHERE</span>
      <span class="n">description</span> <span class="k">LIKE</span> <span class="s1">'%storm'</span>
      <span class="k">AND</span> <span class="n">demand_loss_mw</span> <span class="k">IS</span>  <span class="k">NOT</span> <span class="k">NULL</span>
  <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">description</span>
  <span class="k">HAVING</span> <span class="k">SUM</span><span class="p">(</span><span class="n">demand_loss_mw</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">;</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>The above SQL statement groups the records by description and filters the records with the conditions specified in WHERE clause and then aggregates using the SUM function from the result queires. Then the results after applying aggregating functions are filterd using the conditions specified in the <code class="language-plaintext highlighter-rouge">Having</code> clause.</p></div></blockquote></ul></ul><blockquote class="prompt-tip"><div><ul><li><code class="language-plaintext highlighter-rouge">GROUP BY</code> splits the data up into combination sof one or more values.<li><code class="language-plaintext highlighter-rouge">WHERE</code> filters on row values<li><code class="language-plaintext highlighter-rouge">HAVING</code> appears after the <code class="language-plaintext highlighter-rouge">GROUP BY</code> claues and filters on groups or aggregates</ul></div></blockquote></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/sql/'>SQL</a>, <a href='/categories/1-introduction-to-sql-server/'>1. Introduction to SQL Server</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/sql/" class="post-tag no-text-decoration" >sql</a> <a href="/tags/t-sql/" class="post-tag no-text-decoration" >t-sql</a> <a href="/tags/sum/" class="post-tag no-text-decoration" >sum</a> <a href="/tags/count/" class="post-tag no-text-decoration" >count</a> <a href="/tags/count-distinct/" class="post-tag no-text-decoration" >count distinct</a> <a href="/tags/min/" class="post-tag no-text-decoration" >min</a> <a href="/tags/max/" class="post-tag no-text-decoration" >max</a> <a href="/tags/avg/" class="post-tag no-text-decoration" >avg</a> <a href="/tags/len/" class="post-tag no-text-decoration" >len</a> <a href="/tags/left/" class="post-tag no-text-decoration" >left</a> <a href="/tags/right/" class="post-tag no-text-decoration" >right</a> <a href="/tags/charindex/" class="post-tag no-text-decoration" >charindex</a> <a href="/tags/substring/" class="post-tag no-text-decoration" >substring</a> <a href="/tags/replace/" class="post-tag no-text-decoration" >replace</a> <a href="/tags/group-by/" class="post-tag no-text-decoration" >group by</a> <a href="/tags/having/" class="post-tag no-text-decoration" >having</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Aggregating Data - Babin Joshi&amp;url=https://babin411.github.io/posts/1sql2/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Aggregating Data - Babin Joshi&amp;u=https://babin411.github.io/posts/1sql2/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://babin411.github.io/posts/1sql2/&amp;text=Aggregating Data - Babin Joshi" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/wildcards/">Wild Cards Tutorial</a><li><a href="/posts/Linux-Basic-Commands/">Basic Linux Commands</a><li><a href="/posts/3sql4/">Window Functions</a><li><a href="/posts/pandas1/">Introduction to Pandas</a><li><a href="/posts/mongodb-dm4/">4. Patterns 2</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/sql/">sql</a> <a class="post-tag" href="/tags/t-sql/">t-sql</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mongodb/">mongodb</a> <a class="post-tag" href="/tags/curl/">curl</a> <a class="post-tag" href="/tags/wget/">wget</a> <a class="post-tag" href="/tags/avg/">avg</a> <a class="post-tag" href="/tags/count/">count</a> <a class="post-tag" href="/tags/max/">max</a> <a class="post-tag" href="/tags/min/">min</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/5sql3/"><div class="card-body"> <em class="timeago small" data-ts="1652724900" > 2022-05-17 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Functions for Positions</h3><div class="text-muted small"><p> Position Functions LEN() CHARINDEX() PATINDEX() LEN() Returns the number of characters of the provided string. Syntax: LEN...</p></div></div></a></div><div class="card"> <a href="/posts/3sql1/"><div class="card-body"> <em class="timeago small" data-ts="1652552100" > 2022-05-15 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Intermediate To SQL Server</h3><div class="text-muted small"><p> Exploring Data With Aggregation Reviewing summarized values for each column is a common first step in analyzing data If the data exists in a database, fastest way to aggreg...</p></div></div></a></div><div class="card"> <a href="/posts/4sql3/"><div class="card-body"> <em class="timeago small" data-ts="1652638500" > 2022-05-16 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Basic Aggregate Functions</h3><div class="text-muted small"><p> Key Aggregation Functions Counts COUNT() COUNT_BIG() COUNT(DISTINCT) Other Aggregates SUM() ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/1sql1/" class="btn btn-outline-primary" prompt="Older"><p>Introduction to SQL Server</p></a> <a href="/posts/1sql3/" class="btn btn-outline-primary" prompt="Newer"><p>Joining Tables</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/Babinjoshi411">Babin Joshi</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/sql/">sql</a> <a class="post-tag" href="/tags/t-sql/">t-sql</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mongodb/">mongodb</a> <a class="post-tag" href="/tags/curl/">curl</a> <a class="post-tag" href="/tags/wget/">wget</a> <a class="post-tag" href="/tags/avg/">avg</a> <a class="post-tag" href="/tags/count/">count</a> <a class="post-tag" href="/tags/max/">max</a> <a class="post-tag" href="/tags/min/">min</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
